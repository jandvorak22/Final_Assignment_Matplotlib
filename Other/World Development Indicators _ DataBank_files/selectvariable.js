function initSelectVariables(){initMetadataView()}function doAjaxPostbackVariables(n){var i=$("#hdnSelectVars").val().replace(/'/g,"\\'"),t=null;return $.ajax({type:"POST",async:!1,url:gbl_report_methods+"/SetDimensionMembers",contentType:"application/json; charset=utf-8",data:"{reporttype: '"+n+"', dimensiondetails: '"+i+"'}",dataType:"json",success:function(n){t=n.d},error:function(){window.location.href=gbl_error_file}}),t}function onUpdateVarsClick(){var n,t;return hasclearedallselections(!0)?!1:(n=checkvariablelimit(),n)?($(".formatList #liTable,.formatList #liTable a").addClass("disabled"),$(".formatList #liTable,.formatList #liTable a").removeClass("active"),$(".formatList #liChart,.formatList #liChart a").addClass("disabled"),$(".formatList #liMap,.formatList #liMap a").addClass("disabled"),$(".formatList #liMetadata,.formatList #liMetadata a").addClass("disabled"),$("#faded").show(),$(".downloadMsg").show(),$(".selectionModifyTxt").is(":visible")&&$(".selectionModifyTxt").hide(),$("#divNoDataToDisplay").is(":visible")&&$("#divNoDataToDisplay").hide(),!1):($(".formatList #liTable,.formatList #liTable a").removeClass("disabled"),$(".formatList #liChart,.formatList #liChart a").removeClass("disabled"),$(".formatList #liMap,.formatList #liMap a").removeClass("disabled"),$(".formatList #liMetadata,.formatList #liMetadata a").removeClass("disabled"),$("#faded").hide(),$(".downloadMsg").hide(),$("#upReportDD").show(),$("#cbpReportView").show(),$("#divNoDataToDisplay").hide(),t=$.map(gbl_array_member_selected,function(n,t){var u=[],i,r,f;return $("#tbl_sel_"+t+" li").each(function(n,t){u.push($(t).attr("uniqueid"))}),i=null,$("#tbl_"+t).attr("data-type")=="S"&&$("#tb-indicatorAggRule tbody tr").length>0&&$("#lblApplyAll").hasClass("active")&&(i={AggregationMethod:$("#divApplyAll table select.aggrmethod").val(),AggregationPer:$("#divApplyAll table input.txt-percen").val()}),r={},f=$.map(u,function(i){var u=!1;return $("#tbl_"+t).attr("data-type")=="S"&&$("#tb-indicatorAggRule tbody tr").length>0&&$("#lblChooseForAll").hasClass("active")&&(n[i].AggregationRule={AggregationMethod:$('#tb-indicatorAggRule tbody tr[uniqueid="'+i+'"] select.aggrmethod').val(),AggregationPer:$('#tb-indicatorAggRule tbody tr[uniqueid="'+i+'"] input.txt-percen').val()},u=!0),r[i]=n[i],{uniquename:i,displayname:n[i].displayname,iscustom:n[i].custom,customdefinition:n[i].custom?n[i].customdefinition:null,AggregationRule:u?n[i].AggregationRule:null}}),gbl_array_member_selected_clone[t]=jQuery.extend(!0,{},r),{controlid:t,memberdetails:f,aggregationruleall:i}}),$("#hdnSelectVars").val(JSON.stringify(t)),$("#hdnReportType").val()=="METADATA")?getSelectedMetaAttribs():!0}function updatevariablesfordownload(){var n=$.map(gbl_array_member_selected,function(n,t){var r=[],i,u;return $("#tbl_sel_"+t+" li").each(function(n,t){r.push($(t).attr("uniqueid"))}),i=null,$("#tbl_"+t).attr("data-type")=="S"&&$("#tb-indicatorAggRule tbody tr").length>0&&$("#lblApplyAll").hasClass("active")&&(i={AggregationMethod:$("#divApplyAll table select.aggrmethod").val(),AggregationPer:$("#divApplyAll table input.txt-percen").val()}),u=$.map(r,function(i){var r=!1;return $("#tbl_"+t).attr("data-type")=="S"&&$("#tb-indicatorAggRule tbody tr").length>0&&$("#lblChooseForAll").hasClass("active")&&(n[i].AggregationRule={AggregationMethod:$('#tb-indicatorAggRule tbody tr[uniqueid="'+i+'"] select.aggrmethod').val(),AggregationPer:$('#tb-indicatorAggRule tbody tr[uniqueid="'+i+'"] input.txt-percen').val()},r=!0),{uniquename:i,displayname:n[i].displayname,iscustom:n[i].custom,customdefinition:n[i].custom?n[i].customdefinition:null,AggregationRule:r?n[i].AggregationRule:null}}),{controlid:t,memberdetails:u,aggregationruleall:i}});$("#hdnSelectVars").val(JSON.stringify(n));setSelectedVariables()}function setSelectedVariables(){var n="";return $.ajax({type:"POST",async:!1,url:gbl_select_variables_url,cache:!1,data:$("#hdnSelectVars").serialize(),success:function(t){n=t},error:function(t){n=t.responseText}}),n}function checkvariablelimit(){var n=1;return $(".selectionCount").each(function(t,i){var r=$(i).parents(".panel").find(".selectedView").attr("id");($(i).parents(".panel").attr("id")=="zoomModalHeader"&&(n=parseInt(n*i.textContent||i.innerText)),r!=null)&&(r=r.replace("tbl_sel_",""),r!="MetaAttr"&&r!="DBList")&&(n=parseInt(n*i.textContent||i.innerText))}),n>gbl_report_Cell_Limit?(!gbl_common_internal&&n>gbl_download_Cell_Limit?($(".downloadMsg").text(gbl_msg_report_Download_Limit.replace("__",n)),isdownloadlimit=!0,$(".downloadMsg").removeClass("topRightDisplay")):($(".downloadMsg").text(gbl_msg_report_Cell_Limit.replace("__",n)),$(".downloadMsg").addClass("topRightDisplay")),!0):!1}function loadAvailableList(n,t,i){var u,r=$(i).parents(".panel-heading").find(".panel-title a")[0],f=gbl_array_data[n+"_"+t];f!=null?u=f.DT:r!=null&&(r.innerText!=null&&r.innerText.trim()=="Time"||r.title=="Add Time")&&(u="T");gbl_high_freequencyenabled&&u=="T"&&($("#highfreequencytab").show(),$("#lblSlider").show(),$("div#slider-range").show());loadDimensionList(n,t,r);gbl_high_freequencyenabled&&u=="T"&&document.getElementById("hfAnualTab").click()}function loadSelectedList(n,t,i){var u,r=$(i).parents(".panel-heading").find(".panel-title a")[0],f=gbl_array_data[n+"_"+t];f!=null?u=f.DT:r!=null&&(r.innerText!=null&&r.innerText.trim()=="Time"||r.title=="Add Time")&&(u="T");gbl_high_freequencyenabled&&u=="T"&&($("#highfreequencytab").hide(),$("#lblSlider").hide(),$("div#slider-range").hide());loadDimensionList(n,t,r)}function loadDimensionList(n,t,i){var u,r,o,f,e;if(i!=null&&!$(i).hasClass("collapsed")&&!$(i).hasClass("addMoreRHS")){$(i).parents(".panel-heading").find(".toggleSelectionViews a").removeClass("active");return}$("#report-loading").show();r=gbl_array_data[n+"_"+t];u=r!=null?r.DT:i!=null&&(i.innerText!=null&&i.innerText.trim()=="Time"||i.title=="Add Time")?"T":$("#tbl_"+n).attr("data-type");TrackFeature("Variables->"+getPanelHeading(i));r==null?(gbl_array_data[n+"_"+t]="Loading",gbl_subnational_pagination=$("#hdnSubnationalPagination").val()&&$("#hdnSubnationalPagination").val().trim().toUpperCase()=="Y"?!0:!1,gbl_subnational_singleView=$("#hdnSubnationalSingleView").val()&&$("#hdnSubnationalSingleView").val().trim().toUpperCase()=="Y"?!0:!1,o=new Date,gbl_subnational_pagination&&gbl_CubeIsSubnational&&u==="C"?(gbl_subnationalHierarchy=t,e=gbl_report_methods+"/GetDimensionByLevelJSON",f="{cubeid: '"+$("#hdnCubeID").val()+"', controlid: '"+n+"', hierarchy: '"+t+"', level: 0, parentcode: '',filtername:'',searchkey:''}"):(e=gbl_report_methods+"/GetDimensionJSON",f="{cubeid: '"+$("#hdnCubeID").val()+"', controlid: '"+n+"', hierarchy: '"+t+"'}"),$.ajax({type:"POST",async:!0,url:e,contentType:"application/json; charset=utf-8",data:f,dataType:"json",success:function(i){u=i.d.DT;u=="T"&&(gbl_time_control_Id=n,gbl_time_target_Id="#tbl_"+n);i.d!==null&&(u==="C"&&(gbl_SubnationalFilter=i.d.SubNationalEnabled,gbl_SubnationalFilter&&(gbl_subnational_pagination&&i.d.LevelCount.length>0&&(gbl_subnationalTotalCount=i.d.LevelCount.reduce((n,t)=>n+t,0)),gbl_subnational_pagination&&$(".dimension-hierarchy-"+n).attr("disabled","disabled"),showSubnationals(n,i.d,t))),i.d.HighFrequencyEnabled===!0&&u==="T"?(gbl_high_freequencyenabled=!0,gbl_high_frequency_array_data=i.d.HighFrequencyMembers,$(".customPagination").hide(),gbl_array_data[n+"_"+t]=i.d,GenerateHFControls(),i.d.HighFrequencyMembers!=null&&i.d.HighFrequencyMembers.A!=null&&($("#hfAnualTab").show(),n=gbl_time_control_Id+"_Year",createDimensionList(n,t,!0,!0,"A")),i.d.HighFrequencyMembers!=null&&i.d.HighFrequencyMembers.Q!=null&&($("#hfQuarterlyTab").show(),n=gbl_time_control_Id+"_Quater",createDimensionList(n,t,!0,!0,"Q")),i.d.HighFrequencyMembers!=null&&i.d.HighFrequencyMembers.M!=null&&($("#hfMonthlyTab").show(),n=gbl_time_control_Id+"_Month",createDimensionList(n,t,!0,!0,"M")),i.d.HighFrequencyMembers!=null&&i.d.HighFrequencyMembers.W!=null&&($("#hfWeeklyTab").show(),n=gbl_time_control_Id+"_Week",createDimensionList(n,t,!0,!0,"W")),i.d.HighFrequencyMembers!=null&&i.d.HighFrequencyMembers.D!=null&&($("#hfDailyTab").show(),n=gbl_time_control_Id+"_Day",createDimensionList(n,t,!0,!0,"D")),SetDefaultTab(i.d.HighFrequencyMembers),LoadCustomTime(i.d.Members)):($("#timedimvariableList ul.availableView").show(),$("#hfvariableList").hide(),$("#HighFequencyFilter").hide(),i.d.HighFrequencyEnabled==!0&&(gbl_high_freequencyenabled=!0),gbl_array_data[n+"_"+t]=i.d,createDimensionList(n,t,!0)));$("#report-loading").hide();initDragDrop()},error:function(){gbl_array_data[n+"_"+t]=null;$("#report-loading").hide();window.location.href=gbl_error_file}})):(gbl_high_freequencyenabled==!0&&u=="T"?($("#hfvariableList").show(),$("#HighFequencyFilter").show(),SetDefaultTab(r.HighFrequencyMembers),LoadCustomTime(r.Members)):gbl_SubnationalFilter&&u=="C"&&($("#newSelection_"+n+" #SubNAtionalButtonGrp").show(),$("#newSelection_"+n+" .SubnationalAvailableView").show()),r=gbl_high_freequencyenabled&&$("#tbl_"+n).attr("data-type")=="T"?gbl_array_data[gbl_time_control_Id+"_"+t]:gbl_array_data[n+"_"+t],i==null?createDimensionList(n,t,!0):r.HasDimensionFiltering&&r.Parentdimension!=null&&gblselectionChanged[r.Parentdimension]&&(gblselectionChanged[r.Parentdimension]=!1,createDimensionList(n,t,!0)),$("#report-loading").hide())}function LoadSubNationalChildren(n,t,i,r,u,f){$("#report-loading").show();var e={},o=gbl_report_methods+"/GetDimensionByLevelJSON",s="{cubeid: '"+$("#hdnCubeID").val()+"', controlid: '"+n+"', hierarchy: '"+t+"', level: "+i+", parentcode: '"+r+"',filtername:'"+f+"', searchkey:'"+u+"'}";return $.ajax({type:"POST",async:!1,url:o,contentType:"application/json; charset=utf-8",data:s,dataType:"json",success:function(n){n&&n.d&&n.d.Members&&(e=n.d.Members);$("#report-loading").hide()},error:function(){gbl_array_data[n+"_"+t]=null;$("#report-loading").hide();window.location.href=gbl_error_file}}),e}function SetDefaultTab(n){n!=null&&n.A!=null?document.getElementById("hfAnualTab").click():n!=null&&n.Q!=null?document.getElementById("hfQuarterlyTab").click():n!=null&&n.M!=null?document.getElementById("hfMonthlyTab").click():n!=null&&n.W!=null?document.getElementById("hfWeeklyTab").click():n!=null&&n.D!=null&&document.getElementById("hfDailyTab").click()}function GenerateHFControls(){$("#timedimvariableList ul.availableView").hide();$("#hfAnualTab").hide();$("#hfQuarterlyTab").hide();$("#hfMonthlyTab").hide();$("#hfWeeklyTab").hide();$("#hfDailyTab").hide();$("#HighFequencyFilter div.hierarchy").hide();$("#hfvariableList").show();$("#highfreequencytab").show();$("#HighFequencyFilter").show()}function openTab(n,t){var f,i,r,u,o,e;for($("div#HighFequencyFilter input.filter-check").prop("checked",!1),gbl_selected_time_dim_tab=t,t=="hfyear"?(r=gbl_high_frequency_array_data.A[0].Name,i=gbl_high_frequency_array_data.A[gbl_high_frequency_array_data.A.length-1].Name,$("#year").text(i+" - "+r),f=gbl_high_frequency_array_data.A.length,$("div.variableFilter").hide(),$("#zoomModalBody").find(".variableList")&&$("#zoomModalBody").find(".variableList").width("100%"),$("#lblSlider").show(),$("#slider-range").show(),initSlider(1,f)):t=="hfquater"?(r=gbl_high_frequency_array_data.Q[0].Name,i=gbl_high_frequency_array_data.Q[gbl_high_frequency_array_data.Q.length-1].Name,$("#year").text(i+" - "+r),f=gbl_high_frequency_array_data.Q.length,$("div.variableFilter").show(),$('span.toggleListText:contains("Annual")').parents("li.showTab").show(),$('span.toggleListText:contains("Quarterly")').parents("li.showTab").hide(),$('span.toggleListText:contains("Monthly")').parents("li.showTab").hide(),$('span.toggleListText:contains("Weekly")').parents("li.showTab").hide(),$("#lblSlider").hide(),$("#slider-range").hide()):t=="hfmonth"?(r=gbl_high_frequency_array_data.M[0].Name,i=gbl_high_frequency_array_data.M[gbl_high_frequency_array_data.M.length-1].Name,$("#year").text(i+" - "+r),f=gbl_high_frequency_array_data.M.length,$("div.variableFilter").show(),$('span.toggleListText:contains("Annual")').parents("li.showTab").show(),$('span.toggleListText:contains("Quarterly")').parents("li.showTab").show(),$('span.toggleListText:contains("Monthly")').parents("li.showTab").hide(),$('span.toggleListText:contains("Weekly")').parents("li.showTab").hide(),$("#lblSlider").hide(),$("#slider-range").hide()):t=="hfweek"?(r=gbl_high_frequency_array_data.W[0].Name,i=gbl_high_frequency_array_data.W[gbl_high_frequency_array_data.W.length-1].Name,$("#year").text(i+" - "+r),f=gbl_high_frequency_array_data.W.length,$("div.variableFilter").show(),$('span.toggleListText:contains("Annual")').parents("li.showTab").show(),$('span.toggleListText:contains("Quarterly")').parents("li.showTab").show(),$('span.toggleListText:contains("Monthly")').parents("li.showTab").show(),$('span.toggleListText:contains("Weekly")').parents("li.showTab").hide(),$("#lblSlider").hide(),$("#slider-range").hide()):t=="hfday"&&(r=gbl_high_frequency_array_data.D[0].Name,i=gbl_high_frequency_array_data.D[gbl_high_frequency_array_data.D.length-1].Name,$("#year").text(i+" - "+r),f=gbl_high_frequency_array_data.D.length,$("div.variableFilter").show(),$('span.toggleListText:contains("Annual")').parents("li.showTab").show(),$('span.toggleListText:contains("Quarterly")').parents("li.showTab").show(),$('span.toggleListText:contains("Monthly")').parents("li.showTab").show(),$('span.toggleListText:contains("Weekly")').parents("li.showTab").show(),$("#lblSlider").hide(),$("#slider-range").hide()),o=document.getElementsByClassName("tabcontent"),u=0;u<o.length;u++)o[u].style.display="none";for(e=document.getElementsByClassName("highfreequencytablinks"),u=0;u<e.length;u++)e[u].className=e[u].className.replace(" active","");document.getElementById(t).style.display="block";n!=null?n.currentTarget.className+=" active":$("#hfAnualTab").addClass("active");TrackFeature("Select High Frequency filter")}function GetHighFrequencyControlId(n){return gbl_selected_time_dim_tab=="hfyear"?n=n+"_Year":gbl_selected_time_dim_tab=="hfquater"?n=n+"_Quater":gbl_selected_time_dim_tab=="hfmonth"?n=n+"_Month":gbl_selected_time_dim_tab=="hfweek"?n=n+"_Week":gbl_selected_time_dim_tab=="hfday"&&(n=n+"_Day"),n}function GetHighFrequencyTargetId(n){return gbl_selected_time_dim_tab=="hfyear"?n=n+"_Year":gbl_selected_time_dim_tab=="hfquater"?n=n+"_Quater":gbl_selected_time_dim_tab=="hfmonth"?n=n+"_Month":gbl_selected_time_dim_tab=="hfweek"?n=n+"_Week":gbl_selected_time_dim_tab=="hfday"&&(n=n+"_Day"),n}function GetHighFrequencyDataSource(){var n;return gbl_selected_time_dim_tab=="hfyear"?n=gbl_high_frequency_array_data.A:gbl_selected_time_dim_tab=="hfquater"?n=gbl_high_frequency_array_data.Q:gbl_selected_time_dim_tab=="hfmonth"?n=gbl_high_frequency_array_data.M:gbl_selected_time_dim_tab=="hfweek"?n=gbl_high_frequency_array_data.W:gbl_selected_time_dim_tab=="hfday"&&(n=gbl_high_frequency_array_data.D),n}function GetFilteredSelectedResult(n,t){var i={};return Object.keys(n).filter(function(r){n[r]&&n[r].MemberType==t&&(i[r]=n[r])}),i}function IsHighFrequencyControlID(n){return n==gbl_time_control_Id+"_Year"||n==gbl_time_control_Id+"_Quater"||n==gbl_time_control_Id+"_Month"||n==gbl_time_control_Id+"_Week"||n==gbl_time_control_Id+"_Day"?!0:!1}function CombineSelectedResults(n){var t=0;return Object.keys(n).filter(function(i){IsHighFrequencyControlID(i)&&n[i]&&Object.keys(n[i]).length>0&&(t=t+Object.keys(n[i]).length)}),t}function GetAllHighFrequencyDataLength(n){var t=0;return n[gbl_time_control_Id+"_Year"]&&(t=t+n[gbl_time_control_Id+"_Year"].length),n[gbl_time_control_Id+"_Quater"]&&(t=t+n[gbl_time_control_Id+"_Quater"].length),n[gbl_time_control_Id+"_Month"]&&(t=t+n[gbl_time_control_Id+"_Month"].length),n[gbl_time_control_Id+"_Week"]&&(t=t+n[gbl_time_control_Id+"_Week"].length),n[gbl_time_control_Id+"_Day"]&&(t=t+n[gbl_time_control_Id+"_Day"].length),t}function CombinedTimeDimensionsValues(n,t){for(var r=[],u=!1,i=0;i<n.length;i++)(n[i].controlid==t+"_Year"||n[i].controlid==t+"_Month"||n[i].controlid==t+"_Quater"||n[i].controlid==t+"_Week"||n[i].controlid==t+"_Day")&&(r=r.concat(n[i].memberdetails),delete n[i]);for(i=0;i<n.length;i++)n[i]!=null&&n[i].controlid==t&&(n[i].memberdetails=r,u=!0);return u||n.push({controlid:t,memberdetails:r,aggregationruleall:null}),n}function createDimensionList(n,t,i,r,u){var e="#tbl_"+n,f,o,s,h;if(f=gbl_high_freequencyenabled&&$("#tbl_"+n).attr("data-type")=="T"?Object.assign({},gbl_array_data[gbl_time_control_Id+"_"+t]):Object.assign({},gbl_array_data[n+"_"+t]),f!=null){if(gbl_high_freequencyenabled&&$("#tbl_"+n).attr("data-type")=="T"?gbl_array_member_selected[gbl_time_control_Id]==null&&(gbl_array_member_selected[gbl_time_control_Id]=f.Sel,GenarateAdobeDimensions(gbl_time_control_Id),gbl_array_member_selected_clone[gbl_time_control_Id]=jQuery.extend(!0,{},f.Sel)):gbl_array_member_selected[n]==null&&(gbl_array_member_selected[n]=f.Sel,GenarateAdobeDimensions(n),gbl_array_member_selected_clone[n]=jQuery.extend(!0,{},f.Sel)),f.HasDimensionFiltering&&f.Parentdimension!=null&&(f.Members=FilterParentCodes(n,t)),initFilter(n,t,e,i,f),f.CL&&f.Levels!=null&&f.CHL.length>0?loadClassificationFilter(n,t,e,i,f.CHL):loadFilter(n,t,e,i,f.Levels),f.CL)o=f.Aggr!=null?$.merge($.merge([],f.Members),f.Aggr):f.Members,s=f.JTLA!=null?$.merge($.merge([],f.JTL),f.JTLA):f.JTL,f.DT=="C"&&gbl_SubnationalFilter?(loadDimMembers(n,e,i,o,s,!1),h="div#CtryAgg_Classification_"+n+" label.CtryAgg_Classification[data-value='Aggregates']",$(h)&&$(h).text("Subnational")):(sortAllSelectedItems($("#tbl_"+n),!0),loadDimMembers(n,e,i,o,s,!1));else if(r==!0)switch(u){case"A":loadDimMembers(n,"#tbl_"+n,i,f.HighFrequencyMembers.A,f.JTL,!1);break;case"Q":loadDimMembers(n,"#tbl_"+n,i,f.HighFrequencyMembers.Q,f.JTL,!1);break;case"M":loadDimMembers(n,"#tbl_"+n,i,f.HighFrequencyMembers.M,f.JTL,!1);break;case"W":loadDimMembers(n,"#tbl_"+n,i,f.HighFrequencyMembers.W,f.JTL,!1);break;case"D":loadDimMembers(n,"#tbl_"+n,i,f.HighFrequencyMembers.D,f.JTL,!1)}else loadDimMembers(n,e,i,f.Members,f.JTL,!1);getSelectedMembers(n,e);f.AutoSelect&&(f.Sel==null||Object.keys(f.Sel).length==0)&&getAutoSelect(n,e)}}function FilterParentCodes(n,t){var s,f,i,h=[],l=[],e=[],r=[],c,o,u;if(i=gbl_high_freequencyenabled&&$("#tbl_"+n).attr("data-type")=="T"?gbl_array_data[gbl_time_control_Id+"_"+t]:gbl_array_data[n+"_"+t],f=gbl_array_member_selected[i.Parentdimension],f!=null&&Object.keys(f).length>0){for(c=Object.keys(f),o=0;o<c.length;o++)r=c[o].split("&"),r!==null&&r.length>1&&(r=r[1].slice(1,-1),h.push(r));if(h.length>0){for(u=0;u<i.Members.length;u++)s=i.Members[u].ParentMember,s!=null&&(e=s.split(","),e!=null&&e.length>0&&e.some(n=>n!=null&&h.includes(n.trim()))&&l.push(i.Members[u]));return l}}return i.Members}function loadDimMembers(n,t,i,r,u,f,e){var s,o,c,h;if(r===null){alert("Failed to load members. Either session expired or unable to process the database. Please contact the administrator.");return}o=$(t).attr("data-type");f||(gbl_array_member_list[n]=r,$(t).parents(".panel").find(".searchResults").hide());s=gbl_high_freequencyenabled&&o=="T"?gbl_array_member_selected[gbl_time_control_Id]:gbl_array_member_selected[n];s===null&&(s={});c=n==="DBList";$("#ulJumpToList_"+n).html("");u!==null&&$.each(u,function(t,i){$("#ulJumpToList_"+n).append('<li class="jumpTo"><a href="javascript:void(0)">'+i+"<\/a><\/li>")});gbl_display_list[n]=r;o==="T"?(stringBuilder_Time(n,t,i,gbl_display_list[n]),gbl_high_freequencyenabled&&(h=GetAllHighFrequencyDataLength(gbl_display_list),$(t).parents(".panel").hasClass("modal-body")?$(t).parents(".modal-content").find(".availableCount").text(h):$(t).parents(".panel").find(".availableCount").text(h)),timeDimArray=gbl_display_list[n],gbl_high_freequencyenabled||gbl_selected_time_dim_tab!="hfyear"||initSlider(1,timeDimArray.length),createPagerDropdown(n,timeDimArray)):(o==="C"&&gbl_SubnationalFilter?SubnationalOnload(r,n,t,f,e):stringBuilder(n,t,i,gbl_display_list[n]),createPagerDropdown(n,gbl_display_list[n]))}function initPagination(){$("body").on("click",".showNext",function(){var n=$(this).attr("data-source"),r=$(this).attr("target-id"),u=$(this).attr("data-input"),f=eval($(this).attr("metadata")),e=eval($(this).attr("custom-option")),t,i;gbl_start_var=gbl_end_var;gbl_end_var=gbl_end_var+threshold;gbl_subnational_pagination&&gbl_SubnationalFilter&&$("#tbl_"+n).attr("data-type")==="C"?(t=$("#SubNAtionalButtonGrp label.active").attr("Level"),openSubNationalTab(null,t)):stringBuilder(n,r,!1,gbl_display_list[n]);i=eval($("#goTo_"+n).val())+1;$(".goTo").val(i)});$("body").on("click",".showPrev",function(){var n=$(this).attr("data-source"),r=$(this).attr("target-id"),u=$(this).attr("data-input"),f=eval($(this).attr("metadata")),e=eval($(this).attr("custom-option")),t,i;gbl_start_var=gbl_start_var-threshold;gbl_end_var=gbl_start_var+threshold;gbl_subnational_pagination&&gbl_SubnationalFilter&&$("#tbl_"+n).attr("data-type")==="C"?(t=$("#SubNAtionalButtonGrp label.active").attr("Level"),openSubNationalTab(null,t)):stringBuilder(n,r,!1,gbl_display_list[n]);i=eval($("#goTo_"+n).val())-1;$(".goTo").val(i)});$("body").on("click",".showNext_Time",function(){var n=$(this).attr("data-source"),t=$(this).attr("target-id"),r=$(this).attr("data-input"),u=eval($(this).attr("metadata")),f=eval($(this).attr("custom-option")),i;gbl_start_var_time=gbl_end_var_time;gbl_end_var_time=gbl_end_var_time+threshold;stringBuilder_Time(n,t,!1,timeDimArray);i=eval($("#goTo_"+n).val())+1});$("body").on("click",".showPrev_Time",function(){var n=$(this).attr("data-source"),i=$(this).attr("target-id"),r=$(this).attr("data-input"),u=eval($(this).attr("metadata")),f=eval($(this).attr("custom-option")),t;gbl_start_var_time=gbl_start_var_time-threshold;gbl_end_var_time=gbl_start_var_time+threshold;stringBuilder_Time(n,i,!1,timeDimArray);t=eval($("#goTo_"+n).val())-1;$(".goTo").val(t)});$("body").on("click",".range",function(){var i;$(this).parents(".panel").find(".unselectAll").trigger("click");$(".selectedDimensionTime  .searchResults ").show();$("div.variableListWrapper div.searchResults ").show();var n=$(this).attr("data-source"),t=$(this).attr("target-id"),r=gbl_array_member_list[n],u=eval($(this).attr("data-range"));gbl_high_freequencyenabled==!0&&$("#tbl_"+n).attr("data-type")=="T"&&(n=GetHighFrequencyControlId(n),t=GetHighFrequencyTargetId(t),r=GetHighFrequencyDataSource());i=r.slice(0,u);timeDimArray=i;stringBuilder_Time(n,t,!1,i);gbl_high_freequencyenabled&&$("#tbl_"+n).attr("data-type")=="T"&&gbl_selected_time_dim_tab=="hfyear"&&initSlider(1,timeDimArray.length);setTimeout(function(){$("#slider-range").parents(".panel").find(".selectAll").trigger("click")},10)});$("body").on("change",".goTo",function(){var t=eval($(this).val()),n=$(this).attr("data-source"),i=$(this).attr("target-id"),u=n.split("_")[1],r;u=="Time"?(gbl_start_var_time=t*threshold-threshold,gbl_end_var_time=t*threshold,timeDimArray=gbl_display_list[n],stringBuilder_Time(n,i,!1,timeDimArray),gbl_high_freequencyenabled&&gbl_selected_time_dim_tab=="hfyear"&&initSlider(1,timeDimArray.length)):(gbl_start_var=t*threshold-threshold,gbl_end_var=t*threshold,gbl_subnational_pagination&&gbl_SubnationalFilter&&$("#tbl_"+n).attr("data-type")==="C"?(r=$("#SubNAtionalButtonGrp label.active").attr("Level"),openSubNationalTab(null,r)):stringBuilder(n,i,!1,gbl_display_list[n]))});$(".availableCount").off("click");$(".availableCount").on("click",function(){$(this).parents(".toggleSelectionViews").find(".showAvailable").trigger("click");var n=$(this).parents(".panel").find("ul.selectedView").attr("data-type");n=="C"&&gbl_SubnationalFilter&&openSubNationalTab(null,"All");TrackFeature("Variables->"+getPanelHeading(this)+"->Select available dimensions")});$(".selectionCount").off("click");$(".selectionCount").on("click",function(){$(this).parents(".toggleSelectionViews").find(".showSelected").trigger("click");var n=$(this).parents(".panel").find("ul.selectedView").attr("data-type");TrackFeature("Variables->"+getPanelHeading(this)+"->Show selected dimensions")})}function stringBuilder(n,t,i,r){var u=0,f=0,h={dataType:"json",dataFields:[{name:"ID",type:"string"},{name:"Code",type:"string"},{name:"Name",type:"string"},{name:"JTC",type:"string"},{name:"SM",type:"boolean"},{name:"IsPublic",type:"string"},{name:"S_LC",type:"string"},],localdata:r},e=gbl_array_member_selected[n],s,o;e==null&&(e={});s=n=="DBList";o=new $.jqx.dataAdapter(h,{loadComplete:function(r){var r=o.records,l=r.length,nt="",tt="",w="",a=$(t).attr("data-type"),v=[],b=[],p,g;if(l>0){if(l<threshold?(u=0,f=l,$("#selectedDimension_"+n+" .customPagination").hide()):(u=gbl_start_var,f=gbl_end_var,$("#selectedDimension_"+n+" .customPagination").show(),$("#selectedDimension_"+n+" .totalCount").text(l),gbl_start_var<=1?($("#selectedDimension_"+n+" .showPrev").attr("disabled","disabled"),u=0):$("#selectedDimension_"+n+" .showPrev").attr("disabled",!1),gbl_end_var<l?$("#selectedDimension_"+n+" .showNext").attr("disabled",!1):(gbl_end_var=l,$("#selectedDimension_"+n+" .showNext").attr("disabled","disabled"),f=l)),$("#selectedDimension_"+n+" .start").text(u+1),$("#selectedDimension_"+n+" .end").text(f),a!="T"){for(p=u;p<f;p++){var h=r[p],k=h.JTC,it=e[h.ID]!=null,y="",d="",c="";it?(d="checked='checked'",y=gbl_SubnationalFilter&&a=="C"&&($("#searchBox_"+n).val()==""||gbl_remove_search)?h.S_LC===null||h.S_LC.toUpperCase()==="NULL"||h.S_LC===""?"class='selected national'":"class='selected subnational'":"class='selected'"):gbl_SubnationalFilter&&a=="C"&&($("#searchBox_"+n).val()==""||gbl_remove_search)&&(y=h.S_LC===null||h.S_LC.toUpperCase()==="NULL"||h.S_LC===""?"class='national'":"class='subnational'");s?(c="<li alphabet= '"+k+"' "+y+" uniqueId='"+h.ID+"' source='"+h.Name+"'>",c+='<a data-text="Metadata for '+h.Name+"\" href='#dbMetadata' data-toggle='modal' data-target='#dbMetadata'><span title='View Metadata' class='metadataIcon1 sprite icon-info' IsPublic='"+h.IsPublic+"' data-value-code='"+h.ID+"'><\/span><\/a>",c+="<input name='databaseName' type='radio' id='radio"+h.ID+"' class='radioSelectElement' "+d+"/>"):(gbl_SubnationalFilter&&a=="C"&&($("#searchBox_"+n).val()==""||gbl_remove_search)?h.S_LC===null||h.S_LC.toUpperCase()==="NULL"||h.S_LC===""?(c="<li alphabet= '"+k+"' "+y+"parent = '"+h.Code+"' uniqueId='"+h.ID.replace(/\'/g,"%27")+"'>",c+="<div class='nationalHeader'><span class='closed caret-n' title='Click here to view subnationals'><\/span> "+h.Name,c+="<div class='btn-group pull-right'><a class='btn selectAllSub btn-default' title='Select all subnationals'><span class='glyphicon  glyphicon-check'><\/span><\/a> <a class='btn unselectAllSub btn-default' title='Unselect all subnationals'><span class='glyphicon glyphicon-remove'><\/span><\/a><\/div><\/div>",c+="<div class='nationalName'>",b=b+h.JTC+","):c="<li alphabet= '' "+y+"child = '"+h.S_LC+"' uniqueId='"+h.ID.replace(/\'/g,"%27")+"'>":c="<li alphabet= '"+k+"' "+y+" uniqueId='"+h.ID.replace(/\'/g,"%27")+"'>",c+=h.SM?'<a data-text="Metadata for '+h.Name+"\" href='#divMetadataCtl' data-toggle='modal' data-target='#divMetadataCtl'><span title='View Metadata' class='metadataIcon sprite icon-info' data-value-code='"+h.Code+"'><\/span><\/a>":"<span class='spacer' style='width:16px;height:16px; display:inline-block; float:left'><\/span>",i&&(c+=h.SM&&a=="S"?"<span class='spacer' style='width:16px;height:16px; display:inline-block; float:left'><\/span><span class='glyphicon glyphicon-plus-sign plusIcon' title='Add to Custom Group'> <\/span> ":"<span class='glyphicon glyphicon-plus-sign plusIcon' title='Add to Custom Group'> <\/span> "),c+="<input type='checkbox' id='chk"+h.ID+"' class='chkSelectElement' "+d+"/>");c+="<span class='value bookunit' >"+h.Name+"<\/span>";c+="<\/li>";nt+=c;v=v+h.JTC+",";a=="T"&&(g='<option value="'+h.ID+'">'+h.Name+"<\/option>",tt+=g,w=g+w)}$(t).html(nt);gbl_SubnationalFilter&&a=="C"&&($("#searchBox_"+n).val()==""||gbl_remove_search)&&$(".national").each(function(){var n=$(this).attr("parent");$(this).siblings("li[child='"+n+"']").length<1&&($(this).find(".closed").addClass("disabled"),$(this).find(".nationalName").show(),gbl_common_culture=="ar"?$(this).find(".nationalName").css("margin-right","0"):$(this).find(".nationalName").css("margin-left","0"),$(this).find(".nationalName").prepend("<span class='closed disabled caret-n'><\/span>"),$(this).find(".nationalHeader").hide())});gbl_SubnationalFilter&&a=="C"&&($("#searchBox_"+n).val()==""||gbl_remove_search)&&(v=b);v.length>0?(v=v.split(","),v=unique(v),$("#ulJumpToList_"+n).html(""),$.each(v,function(t,i){$("#ulJumpToList_"+n).append('<li class="jumpTo"><a href="javascript:void(0)">'+i+"<\/a><\/li>")})):$("#ulJumpToList_"+n).html("");$(t).parents(".panel").hasClass("modal-body")?$(t).parents(".modal-content").find(".availableCount").text(l):$(t).parents(".panel").find(".availableCount").text(l);a=="T"&&($("#selCustomTime_From").html(w),$("#selCustomTime_To").html(tt))}}else l==0&&($(t).html("<div class='noRecords'>No Records<\/div>"),$(t).parents(".panel").find(".availableCount").text("0"));gbl_array_member_selected[n]=e;GenarateAdobeDimensions(n);$(".metadataIcon").on("click",function(){var i=$(this).attr("data-value-code"),n=$(this).closest("li").find("span.value").text(),r=$(this).closest("ul").attr("data-type"),t=$(this).closest("ul").attr("data-text");loadMetaDataVariable(n,i,r,t);TrackFeature("Variables->"+t+"->Metadata->"+n)});$(".metadataIcon1").on("click",function(){var n=$(this).attr("data-value-code"),t=$(this).attr("IsPublic");loadDatabaseDetails(n,t);TrackFeature("Variables->Database->Metadata->"+n)});$(".bookunit").mouseover(function(){var i=$(this).closest("ul").attr("data-type"),t,n;i=="S"&&gbl_HasIndicatorUnit&&(t=$(this).closest("li").attr("uniqueid"),n=$.grep(gbl_array_book_attributes,function(n){return n.seriesId==t}),n!=null&&n.length>0&&(strBookUnitName=n[0].bookUnit,$(this).attr("title",strBookUnitName)))})},loadError:function(){},beforeLoadComplete:function(){},afterLoadComplete:function(){}});o.dataBind()}function unique(n){return $.grep(n,function(t,i){return i==$.inArray(t,n)})}function stringBuilder_Time(n,t,i,r){var h=$(t).attr("data-type"),u=0,f=0,s,e,o;s=gbl_high_freequencyenabled?{dataType:"json",dataFields:[{name:"ID",type:"string"},{name:"Code",type:"string"},{name:"Name",type:"string"},{name:"JTC",type:"string"},{name:"SM",type:"boolean"},{name:"HighFrequencyOrderBy",type:"string"}],localdata:r}:{dataType:"json",dataFields:[{name:"ID",type:"string"},{name:"Code",type:"string"},{name:"Name",type:"string"},{name:"JTC",type:"string"},{name:"SM",type:"boolean"}],localdata:r};e=gbl_high_freequencyenabled&&h=="T"?gbl_array_member_selected[gbl_time_control_Id]:gbl_array_member_selected[n];e==null&&(e={});o=new $.jqx.dataAdapter(s,{loadComplete:function(i){var i=o.records,r=i.length,b="",a="",h="",l="",v,y,p,c,w,g,nt;if(r>0){for(r<threshold?(u=0,f=r,l=r/4,$("#selectedDimension_"+n+" .customPagination").hide(),timePaging=!1):(l=threshold/4,u=gbl_start_var_time,f=gbl_end_var_time,$("#selectedDimension_"+n+" .customPagination").show(),timePaging=!0,$("#selectedDimension_"+n+" .totalCount").text(r),gbl_start_var_time<=1?($("#selectedDimension_"+n+" .showPrev_Time").attr("disabled","disabled"),u=0):$("#selectedDimension_"+n+" .showPrev_Time").attr("disabled",!1),gbl_end_var_time<r?$("#selectedDimension_"+n+" .showNext_Time").attr("disabled",!1):(gbl_end_var_time=r,$("#selectedDimension_"+n+" .showNext_Time").attr("disabled","disabled"),f=r,l=(f-u)/4)),$("#selectedDimension_"+n+" .start").text(u+1),$("#selectedDimension_"+n+" .end").text(f),liCounter=u,v=0,y=v;y<4;y++){for(h=h+"<ul class='colUl'>",p=0;p<l;p++)if(liCounter<f){var s=i[liCounter],it=s.JTC,tt=e[s.ID]!=null,k="",d="";tt&&(k="class='selected'",d="checked='checked'");c="<li alphabet= '' "+k+" uniqueId='"+s.ID+"' orderby='"+s.HighFrequencyOrderBy+"'>";c+="<input type='checkbox' id='chk"+s.ID+"' class='chkSelectElement' "+d+"/>";c+="<span class='value'>"+s.Name+"<\/span>";c+="<\/li>";h+=c;gbl_high_freequencyenabled||(w='<option value="'+s.ID+'">'+s.Name+"<\/option>",b+=w,a=w+a);liCounter++}g=i[0].Name;nt=i[r-1].Name;$("#year").text(nt+" - "+g);h=h+"<\/ul>";v++}$(t).html(h);gbl_high_freequencyenabled||($("#selCustomTime_From").html(a),$("#selCustomTime_To").html(b));$(t).parents(".panel").hasClass("modal-body")?$(t).parents(".modal-content").find(".availableCount").text(r):$(t).parents(".panel").find(".availableCount").text(r)}else r==0&&$(t).html("<div class='noRecords'>No Records<\/div>");gbl_high_freequencyenabled?(gbl_array_member_selected[gbl_time_control_Id]=e,GenarateAdobeDimensions(gbl_time_control_Id)):(gbl_array_member_selected[n]=e,GenarateAdobeDimensions(n))},loadError:function(){},beforeLoadComplete:function(){},afterLoadComplete:function(){}});o.dataBind()}function getAutoSelect(n){$("#panel_"+n+" .btn.selectAll").trigger("click")}function getSelectedMembers(n,t){var u=$(t).parent().find(".selectedView").attr("data-type"),i,r;(i=gbl_high_freequencyenabled&&u=="T"?gbl_array_member_selected[gbl_time_control_Id]:gbl_array_member_selected[n],i!=null)&&(r="",$.each(i,function(i,f){var h=f.orderby,e="",o=!1,s="Add to Custom Group";switch(u){case"C":e="editCustomGroup";break;case"S":o=!0;s="Add to Custom Indicator";e="editCustomIndicator";break;case"T":e="editCustomPeriod"}$(t).parent().find(".selectedView").find('li[uniqueid="'+i+'"]').length<=0&&(r+=f.custom?addCustomMember(n,t,f,!1,e,o,""):"<li class='selected' orderby='"+h+"' uniqueId='"+i+"'><span class='glyphicon glyphicon-plus-sign plusIcon' title='"+s+"'> <\/span><span class='deleteIcon glyphicon glyphicon-remove-circle' title='Remove from selection'><\/span><span class='value'>"+f.displayname+"<\/span><\/li>")}),$(t).parent().find(".selectedView li").each(function(n,r){var u=$(r).attr("uniqueid");i[u]==null&&$(t).parent().find('.selectedView li[uniqueid="'+u+'"]').remove()}),getSelectedCount(n,t),$(t).parent().find(".selectedView").append(r),u=="T"&&$("#ascendingChkBox").prop("checked")&&(myhelper=function(n){return $("span",$(n)).text()},sortTimeAscending($(t).parent().find(".selectedView"))))}function getSelectedCount(n,t){var r,i,u;r=gbl_array_member_selected[n];i=Object.keys(r).length;i>0?$(t).parents(".panel").find(".noVariableTxt").hide():$(t).parents(".panel").find(".noVariableTxt").show();$(t).parents(".panel").hasClass("modal-body")?$(t).parents(".modal-content").find(".selectionCount").text(i):$(t).parents(".panel").find(".selectionCount").text(i);u=gbl_high_freequencyenabled&&$("#tbl_"+n).attr("data-type")=="T"?"#"+gbl_time_control_Id+"_selectCountRHS":"#"+n+"_selectCountRHS";$(u).text(i)}function setSelectionChange(n){var t=$(n).prop("checked"),i=$(n).parents(".panel").find("ul.selectedView").attr("data-type");gbl_SubnationalFilter&&i=="C"?setSelectionChangeEx(n,t,".SubnationalAvailableView"):setSelectionChangeEx(n,t,".availableView")}function setSelectionChangeEx(n,t,i){var l,u,o,e,v,h,c,r;r=$(n).parents(".panel").find(i).attr("data-value");gblselectionChanged[r]=!0;l="#tbl_"+r;u=gbl_array_member_selected[r];o=$(n).parents(".panel").find(i).attr("data-type");u==null&&(u={});var f=$(n).parent("li").attr("uniqueid"),a=$(n).parent("li").attr("orderby"),s=$(n).parent("li").find(".value").text();gbl_SubnationalFilter&&o=="C"&&(f==null?(f=$(n).parent("div").parent("li").attr("uniqueid"),$(n).parent("div").parent("li").find(".value")&&$(n).parent("div").parent("li").find(".value").length>0&&(s=$(n).parent("div").parent("li").children(".value").text())):$(n).parent("li").find(".value")&&$(n).parent("li").find(".value").length>0&&(s=$(n).parent("li").children(".value").text()));o!="S"||$("#aggRuleTxt div.panel-heading a").hasClass("collapsed")||$("#aggRuleTxt div.panel-heading #aDefineAggrRule").trigger("click");t&&u[f]==null?u[f]={displayname:s,custom:!1,orderby:a}:t||u[f]==null||(e=u[f],e.customdefinition!=null&&e.customdefinition.periods!=null&&e.customdefinition.periods.length>0&&($tblavailable=$("#tbl_"+r),$.each(e.customdefinition.periods,function(n,t){$tblavailable.find("input[id='chk"+t.uniquename+"']").prop({checked:!1}).removeAttr("disabled")})),delete u[f]);gbl_array_member_selected[r]=u;r&&GenarateAdobeDimensions(r);getSelectedMembers(r,l);$("#divNoDataToDisplay").is(":hidden")?($("#faded").show(),v=$("#panel_"+r).position(),$(".selectionModifyTxt").show(),$(".downloadMsg").is(":visible")&&$(".downloadMsg").hide(),$(".selectionModifyTxt").attr("panel-id","#panel_"+r)):(h=0,$(".selectionCountRHS").each(function(){var n=eval($(this).text());(n==null||n<1||n=="")&&h++}),h>0?$("#applyChangesNoPreview").addClass("disabled"):($("#applyChangesNoPreview").removeClass("disabled"),$(".allDimSelected.noPreview").show(),$(".dimSelected.noPreview").hide()));o=="S"&&$("#hdnReportType").val()=="CHART"&&gbl_HasIndicatorUnit&&(c=!1,r=$('.variableTable.selectedView[data-type="S"]').attr("data-value"),$(".page-ddl").attr("id")!=null&&$(".page-ddl").attr("id").indexOf(r)>=0&&(c=!0),validateBookUnits()||c||(document.getElementById("selModifyText").innerHTML=gbl_common_labels.Reports_Label_Selection_UnitModified))}function removecustomvariables(n){var i=$(n).parents(".panel").find(".availableView").attr("data-value"),t=gbl_array_member_selected[i];t==null&&(t={});$(n).parents(".panel").find(".selectedView li").each(function(n,i){var r=$(i).attr("uniqueid");r.indexOf("custom_")>=0&&delete t[r]});gbl_array_member_selected[i]=t;GenarateAdobeDimensions(i)}function setSelections(n){var f,e=$(n).parents(".panel").find("ul.selectedView").attr("data-type"),r=$(".variableList").find(".tabcontent:visible").attr("id"),s,u;f=gbl_SubnationalFilter&&e=="C"?r==null?$(n).parents(".panel").find(".SubnationalAvailableView li"):$(n).parents(".panel").find(".SubnationalAvailableView #"+r+" li"):$(n).parents(".panel").find(".availableView li");var i=$(n).parents(".panel").find(".availableView").attr("data-value"),o="#tbl_"+i,t=gbl_array_member_selected[i];t==null&&(t={});f.each(function(i,r){var u=$(r).attr("uniqueid"),e=$(r).children(".value").text(),f=$(r).find(".chkSelectElement").prop("checked"),o=$(n).parent("li").attr("orderby");f&&t[u]==null&&(t[u]={displayname:e,custom:!1,orderby:o});f||t[u]==null||delete t[u]});gbl_SubnationalFilter&&e=="C"&&r==null&&(t={});gbl_array_member_selected[i]=t;GenarateAdobeDimensions(i);getSelectedMembers(i,o);$("#divNoDataToDisplay").is(":hidden")?($("#faded").show(),s=$("#panel_"+i).position(),$(".selectionModifyTxt").show(),$(".downloadMsg").is(":visible")&&$(".downloadMsg").hide(),$(".selectionModifyTxt").attr("panel-id","#panel_"+i)):(u=0,$(".selectionCountRHS").each(function(){var n=eval($(this).text());(n==null||n<1||n=="")&&u++}),u>0?$("#applyChangesNoPreview").addClass("disabled"):($("#applyChangesNoPreview").removeClass("disabled"),$(".allDimSelected.noPreview").show(),$(".dimSelected.noPreview").hide()));$(".downloadMsg").is(":visible")&&$(".downloadMsg").hide()}function setSelectionsBadge(n){var u,o=$(n).parents(".panel").find("ul.selectedView").attr("data-type"),e,r;u=$($(n).parents("ul li")[0]).children().find("li");var t=$(n).parents(".panel").find(".availableView").attr("data-value"),f="#tbl_"+t,i=gbl_array_member_selected[t];i==null&&(i={});u.each(function(t,r){var u=$(r).attr("uniqueid"),e=$(r).children(".value").text(),f=$(r).find(".chkSelectElement").prop("checked"),o=$(n).parent("li").attr("orderby");f&&i[u]==null&&(i[u]={displayname:e,custom:!1,orderby:o});f||i[u]==null||delete i[u]});gbl_array_member_selected[t]=i;GenarateAdobeDimensions(t);getSelectedMembers(t,f);$("#divNoDataToDisplay").is(":hidden")?($("#faded").show(),e=$("#panel_"+t).position(),$(".selectionModifyTxt").show(),$(".downloadMsg").is(":visible")&&$(".downloadMsg").hide(),$(".selectionModifyTxt").attr("panel-id","#panel_"+t)):(r=0,$(".selectionCountRHS").each(function(){var n=eval($(this).text());(n==null||n<1||n=="")&&r++}),r>0?$("#applyChangesNoPreview").addClass("disabled"):($("#applyChangesNoPreview").removeClass("disabled"),$(".allDimSelected.noPreview").show(),$(".dimSelected.noPreview").hide()));$(".downloadMsg").is(":visible")&&$(".downloadMsg").hide()}function initFilter(n,t,i,r,u){if(u.CL)initClassificationFilter(n,t,i,r,u),$("#tbl_"+n).attr("data-type")=="C"&&($("#showCountryAggOption_"+n).hide(),gbl_SubnationalFilter||$("#CtryAgg_Classification_"+n).show());else{$("#tbl_"+n).attr("data-type")=="C"&&($("#showCountryAggOption_"+n).show(),$("#CtryAgg_Classification_"+n).hide());$(".dimension-hierarchy-"+n+" option").length<=0&&(u.Hier!=null&&Object.keys(u.Hier).length>0?($.each(u.Hier,function(t,i){$(".dimension-hierarchy-"+n).append('<option value="'+t+'">'+i+"<\/option>")}),$(".dimension-hierarchy-"+n).val(u.DH)):$(".dimension-hierarchy-"+n).append('<option value="'+u.DH+'">'+u.DH+"<\/option>"));$(".dimension-hierarchy-"+n+" option").length<=1&&$("#hierarchy_"+n).hide();$(".dimension-hierarchy-"+n).off("change");$(".dimension-hierarchy-"+n).on("change",function(){loadDimensionList(n,$(this).val(),null);$(".showCountryAggOption").removeClass("active");$(".showCountryAggOption[data-value='All']").addClass("active")})}}function loadFilter(n,t,i,r,u){var f="",e=n=="DBList";if(u!=null){$.each(u,function(t,i){f+=getFilterList(t,i,e,n)});$("#tbl_"+n).attr("data-type")=="C"&&f.indexOf("filter-check-aggregates")<1&&($("#showCountryAggOption_"+n).hide(),$("#CtryAgg_Classification_"+n).hide());gbl_high_freequencyenabled&&$("#tbl_"+n).attr("data-type")=="T"?$("#lstFilterItems_"+gbl_time_control_Id).html(f):$("#lstFilterItems_"+n).html(f);setTimeout(function(){$("#lstFilterItems_"+n).find("li.show").length==0&&$("#lstFilterItems_"+n).prepend("<em>This hierarchy has no sub-levels.<\/em>")},100);$(".filter-check").on("click",function(){var v,f,u,s,w,h,l,o,y,c,p,a;if($("#report-loading").show(),v=!1,h=$(i).attr("data-type"),gbl_high_freequencyenabled&&h==="T"&&(n=gbl_time_control_Id),s=Object.assign({},gbl_array_data[n+"_"+t]),s.HasDimensionFiltering&&s.Parentdimension!=null&&(s.Members=FilterParentCodes(n,t)),gbl_high_freequencyenabled&&h=="T"?(f=$("#lstFilterItems_"+gbl_time_control_Id+" .filter-check:checked").map(function(n,t){return{datavalue:$(t).attr("data-value"),datalevel:$(t).attr("data-level")}}).toArray(),u=GetHighFrequencyDataSource()):(f=gbl_SubnationalFilter&&h=="C"?$("#lstFilterItems_"+n+" .filter-check:checked").map(function(n,t){return $(t).attr("data-level")!=="1"&&(w=$(t).parent("li")[0].innerText),{datavalue:$(t).attr("data-value"),datalevel:$(t).attr("data-level"),dataname:w}}).toArray():$("#lstFilterItems_"+n+" .filter-check:checked").map(function(n,t){return{datavalue:$(t).attr("data-value"),datalevel:$(t).attr("data-level")}}).toArray(),u=s.Members),l=s.JTL,f.length>0){if(gbl_subnational_pagination&&gbl_SubnationalFilter&&h==="C"){for(v=!0,o="",y=null,c=0;c<f.length;c++)f[c].dataname&&f[c].dataname.trim()!==""&&(o=o+f[c].dataname+"~");o.length>0?o=o.substring(0,o.length-1):y=0;p=[];a=LoadSubNationalChildren(n,t,y,"","",o);p=fillHierarchy(a);a.length>0&&(u=OrderSubnationalData(a.concat(p)))}else gbl_SubnationalFilter&&h=="C"?(u=$.grep(u,function(n){return getSubnationalFilterSelected(f,n)}),u.length>0&&FindSubnationalParents(u,s.Members)):u=$.grep(u,function(t){return getFilterSelected(f,t,e,n)});l=$(u).map(function(n,t){return t.JTC});l=$.unique(l)}gbl_high_freequencyenabled&&h=="T"&&(n=GetHighFrequencyControlId(gbl_time_control_Id),i=GetHighFrequencyTargetId(gbl_time_target_Id));loadDimMembers(n,i,r,u,l,v);$("#report-loading").hide();$(".nonclassification").is(":visible")&&($(".showCountryAggOption").removeClass("active"),$(".showCountryAggOption[data-value='Countries']").addClass("active"));$(this).parents(".panel").find(".searchInput").val("");f.length>0?$(this).parents(".panel").find(".filterResults").show():$(this).parents(".panel").find(".filterResults").hide();wbgData.siteSearch.searchTerm=$(this).parent().prop("innerText");wbgData.siteSearch.searchFilters="dimensionmembers";AnalyticsControlClick("editreports","");TrackFeature("Variables->"+getPanelHeading(this)+"->FilterBy->"+$(this).parent().prop("innerText"))})}}function getSubnationalFilterSelected(n,t){for(var i=0;i<n.length;i++)if(t.HLS!=null&&t.HLS[n[i].datalevel-1]==n[i].datavalue||n[i].datavalue.split("&").pop().replace("[","").replace("]","")==t.Name||n[i].dataname===t.Name)return!0}function filterCountryAggregates(){$("body").on("click",".showCountryAggOption",function(){var n=$(this).attr("controlId"),i=$(this).attr("data-value"),r=$("#ddlDimHierarchy_"+n).val(),t=$("#lstFilterItems_"+n);i=="All"?($("#toggleFilter_"+n).attr("disabled",!1),$("#_filterTree_"+n).removeClass("disabled"),t.find(".filter-check").prop("checked",!1),t.find(".filter-check").trigger("click"),setTimeout(function(){t.find(".filter-check").prop("checked",!1)},100)):i=="Countries"?($("#toggleFilter_"+n).attr("disabled",!1),$("#_filterTree_"+n).removeClass("disabled"),t.find(".filter-check").prop("checked",!1),t.find(".filter-check").trigger("click"),$(".filter-check-aggregates .filter-check").trigger("click"),setTimeout(function(){t.find(".filter-check").prop("checked",!1)},100)):($("#_filterTree_"+n).addClass("disabled"),$("#toggleFilter_"+n).attr("disabled",!0),t.find(".filter-check").prop("checked",!0),t.find(".filter-check").trigger("click"),$(".filter-check-aggregates .filter-check").trigger("click"),setTimeout(function(){t.find(".filter-check").prop("checked",!1)},100));$("#filterResults_"+n).hide()})}function getFilterSelected(n,t,i,r){for(var u=0;u<n.length;u++)if(i||gbl_high_freequencyenabled&&$("#tbl_"+r).attr("data-type")=="T"){if(t.HLS!=null&&t.HLS.indexOf(n[u].datavalue)>=0)return!0}else if(t.HLS!=null&&t.HLS[n[u].datalevel-1]==n[u].datavalue)return!0}function getFilterList(n,t,i,r){var u=""+(t.HID.indexOf("[Aggregates]")>0?'<li class="dispNone filter-check-aggregates">':t.HID.indexOf("[Countries]")>0?'<li class="dispNone filter-check-countries">':gbl_high_freequencyenabled&&$("#tbl_"+r).attr("data-type")=="T"?'<li class="showTab">':'<li class="show">');switch(t.LN){case 1:u+='<div class="parentNode">';t.LV.length>0&&(u+="<span class='toggleList'><\/span>");i||gbl_high_freequencyenabled&&$("#tbl_"+r).attr("data-type")=="T"||(u+='<input type="checkbox" class="masterSelector filter-check" data-value="'+t.HID+'" data-level="'+t.LN+'" />');u+="<span class='toggleListText'>"+t.HN+"<span><\/div>";break;default:t.HN!=="NULL"&&t.HN!==null&&(u+='<input type="checkbox" class="selector filter-check" data-value="'+t.HID+'" data-level="'+t.LN+'" />'+t.HN)}return t.LV.length>0&&(u+='<ul class="childNodes level'+t.LN+'">',$.each(t.LV,function(n,t){u+=getFilterList(n,t,i,r)}),u+="<\/ul>"),u+="<\/li>"}function loadSelectFilterItems(n){var r=$("#divMapRegion .select-filter-check:checked, #divMapIncome .select-filter-check:checked").map(function(n,t){return{datavalue:$(t).attr("value"),filtertype:$(t).attr("filter-type")}}).toArray(),t=$("#divMapRegion").attr("data-type"),u=$.grep(Object.keys(gbl_array_data),function(n){if(n.indexOf(t+"_")==0)return!0}),f=u.length>0?gbl_array_data[u[0]]:null,i;if(r.length>0&&f!=null){i=f.Members;i=$.grep(i,function(n){return getSelectFilterSelected(r,n)});$(n).parents(".panel").find(".selectedView li").remove();$(n).parents(".panel").find(".availableView li .chkSelectElement").prop("checked",!1);$(n).parents(".panel").find(".availableView li").removeClass("selected");var t=$(n).parents(".panel").find(".selectedView").attr("data-value"),s="#tbl_"+t,e={},o="";$.each(i,function(t,i){e[i.ID]={displayname:i.Name,custom:!1};o+="<li class='selected' uniqueId='"+i.ID+"'><span class='glyphicon glyphicon-plus-sign plusIcon' title=''> <\/span><span class='deleteIcon glyphicon glyphicon-remove-circle' title='Remove from selection'><\/span><span class='value'>"+i.Name+"<\/span><\/li>";$(n).parents(".panel").find(".availableView li[uniqueid='"+i.ID+"']").addClass("selected").find(".chkSelectElement").prop("checked",!0)});$(n).parents(".panel").find(".selectedView").append(o);gbl_array_member_selected[t]=e;GenarateAdobeDimensions(t);getSelectedMembers(t,s)}}function getSelectFilterSelected(n,t){for(var r,i=0;i<n.length;i++)if(r=n[i].filtertype=="Region"?0:n[i].filtertype=="Income"?1:-1,r>=0&&t.HLS!=null&&t.HLS[r]==n[i].datavalue)return!0}function initClassificationFilter(n,t,i,r,u){$(".dimension-hierarchy-"+n+" option").length<=0&&$.each(u.Levels,function(t,i){$(".dimension-hierarchy-"+n).append('<option value="'+i.HID+'">'+i.HN+"<\/option>")});$("#hierarchy_"+n).hide();$(".CtryAgg_Classification").click(function(){var s=$(this).attr("data-value"),l=$("#lstFilterItems_"+n),h,c,f,e,o;s=="All"?(u.DT=="C"&&gbl_SubnationalFilter&&(f="div#CtryAgg_Classification_"+n+" label.CtryAgg_Classification[data-value='Aggregates']",$(f)&&$(f).removeClass("active")),h=u.Aggr!=null?$.merge($.merge([],u.Members),u.Aggr):u.Members,c=u.JTLA!=null?$.merge($.merge([],u.JTL),u.JTLA):u.JTL,loadDimMembers(n,i,r,h,c,!1),getSelectedMembers(n,i),u.Levels!=null&&u.CHL.length>0&&loadClassificationFilter(n,t,i,r,u.CHL),$("#toggleFilter_"+n).attr("disabled",!1),u.DT=="C"&&gbl_SubnationalFilter||sortAllSelectedItems($("#tbl_"+n),!0),$("#_filterTree_"+n).removeClass("disabled"),TrackFeature("Variables->Country->Classification->All")):s=="Countries"?(u.DT=="C"&&gbl_SubnationalFilter?(f="div#CtryAgg_Classification_"+n+" label.CtryAgg_Classification[data-value='Aggregates']",$(f)&&$(f).removeClass("active"),loadDimMembers(n,i,r,u.Members,null,!1)):(loadDimMembers(n,i,r,u.Members,u.JTL,!1),getSelectedMembers(n,i),u.Levels!=null&&u.CHL.length>0&&loadClassificationFilter(n,t,i,r,u.CHL),$("#toggleFilter_"+n).attr("disabled",!1),$("#_filterTree_"+n).removeClass("disabled")),TrackFeature("Variables->Country->Classification->Countries")):(u.DT=="C"&&gbl_SubnationalFilter?(loadDimMembers(n,i,r,u.Members,null,!1),e="div#CtryAgg_Classification_"+n+" label.CtryAgg_Classification[data-value='Countries']",o="div#CtryAgg_Classification_"+n+" label.CtryAgg_Classification[data-value='All']",$(e)&&$(e).removeClass("active"),$(o)&&$(o).removeClass("active"),sortAllSelectedItems($("#tbl_"+n),!0)):(loadDimMembers(n,i,r,u.Aggr,u.JTLA,!1),getSelectedMembers(n,i),u.Levels!=null&&u.CHL.length>0&&loadClassificationFilter(n,t,i,r,u.CHL),$("#toggleFilter_"+n).attr("disabled",!0),$("#_filterTree_"+n).addClass("disabled")),TrackFeature("Variables->Country->Classification->Aggregates"));$("#filterResults_"+n).hide();$("#hierarchy_"+n).hide()})}function loadClassificationFilter(n,t,i,r,u){var f="";$.each(u,function(n,t){f+=getClassificationFilterList(n,t)});$("#lstFilterItems_"+n).html(f);$(".filter-check").on("click",function(){var s=!1,o,e,u,f,h;$("#report-loading").show();o=$("#lstFilterItems_"+n+" .filter-check:checked").map(function(n,t){return{datavalue:$(t).attr("data-value"),datalevel:$(t).attr("data-level"),parentindex:$(t).parent().parent().closest("li").attr("data-index")}}).toArray();e=gbl_high_freequencyenabled&&$("#tbl_"+n).attr("data-type")=="T"?gbl_array_data[gbl_time_control_Id+"_"+t]:gbl_array_data[n+"_"+t];u=e.Members;f=e.JTL;o.length>0&&(s=!0,h=e.Members,u=$.grep(h,function(n){return getClassificationSelected(o,n)}),f=$(u).map(function(n,t){return t.JTC}),f=$.unique(f));gbl_SubnationalFilter&&$("#tbl_"+n).attr("data-type")=="C"?(u.length>0&&FindSubnationalParents(u,e.Members),loadDimMembers(n,i,r,u,f,s)):loadDimMembers(n,i,r,u,f,!1);$("#report-loading").hide();$(this).parents(".panel").find(".searchInput").val("");$(this).parents(".panel").find(".searchResults").hide();o.length>0?$(this).parents(".panel").find(".filterResults").show():$(this).parents(".panel").find(".filterResults").hide();$(".classification").is(":visible")&&($(".CtryAgg_Classification").removeClass("active"),$(".CtryAgg_Classification[data-value='Countries']").addClass("active"));wbgData.siteSearch.searchTerm=$(this).parent().prop("innerText");wbgData.siteSearch.searchFilters="dimensionmembers";AnalyticsControlClick("editreports","");TrackFeature("Variables->"+getPanelHeading(this)+"->FilterBy->"+$(this).parent().prop("innerText"))})}function getClassificationSelected(n,t){for(var r=!0,u=[],f=[],e=[],o=!1,s=!1,h=!1,i=0;i<n.length;i++)n[i].parentindex==0?(e.push(n[i].datavalue),s=!0):n[i].parentindex==1?(u.push(n[i].datavalue),o=!0):n[i].parentindex==2&&(f.push(n[i].datavalue),h=!0);return r&&s&&(r=$.grep(t.HLS,function(n){return $.inArray(n,e)!=-1}).length>0?!0:!1),r&&o&&(r=$.grep(t.HLS,function(n){return $.inArray(n,u)!=-1}).length>0?!0:!1),r&&h&&(r=$.grep(t.HLS,function(n){return $.inArray(n,f)!=-1}).length>0?!0:!1),r}function getClassificationFilterList(n,t){var i=""+('<li data-index="'+n+'">');switch(t.LN){case 1:t.HN!=null&&t.HN!=""&&(i+='<div class="parentNode">',i+="<span class='toggleList mT4'><\/span>",i+="<span class='toggleListText'>"+t.HN+"<span><\/div>");break;default:t.HN!=null&&t.HN!=""&&(i+='<input type="checkbox" class="selector filter-check" data-value="'+t.HID+'" data-level="'+t.LN+'" /> '+t.HN)}return t.LV.length>0&&(i+='<ul class="childNodes level'+t.LN+'">',$.each(t.LV,function(n,t){i+=getClassificationFilterList(n,t)}),i+="<\/ul>"),i+="<\/li>"}function initSearch(){function n(n,t,i,r,u){var f=$(i).map(function(n,t){return t.JTC});f=$.unique(f);r=="T"&&(gbl_start_var_time=1,gbl_end_var_time=threshold,timeDimArray=gbl_display_list[n],gbl_high_freequencyenabled&&gbl_selected_time_dim_tab=="hfyear"&&u=="A"&&initSlider(1,timeDimArray.length));gbl_remove_search=!0;loadDimMembers(n,t,!0,i,f,!1);gbl_remove_search=!1;$(t).parents(".panel").find(".searchResults").hide();$(this).parents(".panel").find(".searchInput").val("")}$(".searchBtn").click(function(){var t=$(this).attr("data-source"),r=gbl_array_member_list[t],i=$(this).attr("target-id"),u=$(this).attr("data-input"),e=eval($(this).attr("metadata")),o=eval($(this).attr("custom-option"));if(gbl_high_freequencyenabled==!0&&$("#tbl_"+t).attr("data-type")=="T"&&(t=GetHighFrequencyControlId(t),i=GetHighFrequencyTargetId(i),r=GetHighFrequencyDataSource()),invokeSearch(t,u,r,i,!0),wbgData.siteSearch!==null&&$(this).siblings(".searchInput").val()!==null&&$(this).siblings(".searchInput").val()!==""){var f=$(this).parents(".panel").find(".availableView").attr("data-type"),s=$(".database h2").text().trim(),n="";switch(f){case"T":n="Year";break;case"S":n="Series";break;case"C":n="Country";break;case"D":n="Database";break;case"O":n=$(this).parents(".panel").find(".main-title-panel").text().trim();break;default:n="GeneralQuery"}TrackFeature("Variables->"+n+"->Search");wbgData.siteSearch.searchTerm=$(this).siblings(".searchInput").val();wbgData.siteSearch.searchFilters="dimension:"+n;AnalyticsControlClick("editreports","")}});$(".removeSearch").click(function(){gbl_start_var=1;gbl_end_var=threshold;var u=$(this).attr("data-source"),f=$(this).attr("target-id"),i,r,t=gbl_array_member_list[u],e=$(this).attr("destination_type"),o=eval($(this).attr("metadata")),s=eval($(this).attr("custom-option"));gbl_high_freequencyenabled==!0&&$("#tbl_"+u).attr("data-type")=="T"?($("div#HighFequencyFilter input.filter-check").prop("checked",!1),i=u+"_Quater",r=f+"_Quater",t=gbl_high_frequency_array_data.Q,t!=null&&t.length>0&&n(i,r,t,e,"Q"),i=u+"_Month",r=f+"_Month",t=gbl_high_frequency_array_data.M,t!=null&&t.length>0&&n(i,r,t,e,"M"),i=u+"_Week",r=f+"_Week",t=gbl_high_frequency_array_data.W,t!=null&&t.length>0&&n(i,r,t,e,"W"),i=u+"_Day",r=f+"_Day",t=gbl_high_frequency_array_data.D,t!=null&&t.length>0&&n(i,r,t,"D"),i=u+"_Year",r=f+"_Year",t=gbl_high_frequency_array_data.A,t!=null&&t.length>0&&n(i,r,t,e,"A")):n(u,f,t,e,"");TrackFeature("Variables->"+getPanelHeading(this)+"->RemoveSearch")});$(".removeFilter").click(function(){var n=$(this).attr("data-source"),t=$(this).attr("target-id"),i=$(this).attr("destination_type");$("#_filterTree_"+n).find("input.filter-check:checked").trigger("click");$(this).parents(".panel").find(".searchInput").val("");$(t).parents(".panel").find(".searchResults").hide();$(t).parents(".panel").find(".filterResults").hide();$(".showCountryAggOption").removeClass("active");$(".showCountryAggOption[data-value='All']").addClass("active");i=="T"&&(gbl_start_var_time=1,gbl_end_var_time=threshold,timeDimArray=gbl_display_list[n],gbl_high_freequencyenabled&&gbl_selected_time_dim_tab=="hfyear"&&initSlider(1,timeDimArray.length));TrackFeature("Variables->"+getPanelHeading(this)+"->RemoveFilter")});initPagination()}function invokeSearch(n,t,i,r,u){var e,f,o,s;gbl_start_var=1;gbl_end_var=threshold;e=$(t).val().trim();e==""?$(t).focus():(f=searchRecordsSV(i,e,"Name"),o=$(f).map(function(n,t){return t.JTC}),o=$.unique(o),f.sort(function(n,t){var i=$(n).attr("JTC"),r=$(t).attr("JTC");return i<r?-1:i>r?1:0}),gbl_SubnationalFilter&&$("#tbl_"+n).attr("data-type")==="C"&&(gbl_subnational_pagination?(s=[],f=LoadSubNationalChildren(n,gbl_subnationalHierarchy,null,"",e,""),s=fillHierarchy(f),f.length>0&&(f=f.concat(s)),f.sort(function(n,t){var i=$(n).attr("JTC"),r=$(t).attr("JTC");return i<r?-1:i>r?1:0})):(f=FindSubNationalChilds(i,f),FindSubnationalParents(f,i))),loadDimMembers(n,r,u,f,o,!0),$(r).parents(".panel").find(".searchResults").show())}function searchRecordsSV(n,t,i){for(var u,s,r,h,e=t.split(" "),o=[],f=0;f<e.length;f++)for(u=new $.jqx.filter,s=u.createfilter("stringfilter",e[f],"contains"),u.addfilter(1,s),r=0;r<n.length;r++)h=u.evaluate(n[r][i])||u.evaluate(n[r].Code),h&&o.push(n[r]);return unique(o)}function initJumpToList(){$("body").on("click",".jumpTo",function(){var i,n=$(this).text(),f=$(this).parents(".panel").find("li[alphabet="+n+"]").attr("uniqueid"),t=$(this).parents(".panel").find("ul.selectedView").attr("data-type"),r=0,u;r=t==="C"&&gbl_SubnationalFilter?$(".SubnationalAvailableView div.tabcontent:visible").find("li[alphabet="+n+"]").position().top:$(this).parents(".panel").find("li[alphabet="+n+"]").position().top;i=$(this).parents(".panel").find(".variableList").scrollTop();u=r+i;$(this).parents(".panel").find(".variableList").animate({scrollTop:u},"slow");t==="C"?TrackFeature("Country->Jump to Alphabet->"+n):t==="S"?TrackFeature("Series->Jump to Alphabet->"+n):t==="T"&&TrackFeature("Time->Jump to Alphabet->"+n)})}function initSelectAll(){$("body").on("click",".selectAll",function(){var t=$(this).parents(".panel").find(".availableView").attr("data-value"),i=$("#tbl_"+t).attr("data-type"),n;gblselectionChanged[t]=!0;gbl_high_freequencyenabled==!0&&i=="T"?($(this).parents(".panel").find("#hfvariableList:visible .tabcontent:visible .availableView .chkSelectElement").prop("checked",!0),$(this).parents(".panel").find("#hfvariableList:visible .tabcontent:visible .availableView li").addClass("selected")):gbl_SubnationalFilter&&i=="C"?(n=$(".variableList").find(".tabcontent:visible").attr("id"),$(".variableList").find("#"+n).find(".chkSelectElement").prop("checked",!0),$(".variableList").find("#"+n).find("div:hidden .chkSelectElement").prop("checked",!1),$(".SubnationalAvailableView").find("#"+n).find(".chkSelectElement").addClass("selected"),$(".variableList").find("#"+n).find(".chkSelectElement").trigger("change"),$(".variableList").find("#"+n).find("div:hidden .chkSelectElement").trigger("change")):($(this).parents(".panel").find(".availableView .chkSelectElement").prop("checked",!0),$(this).parents(".panel").find(".availableView li").addClass("selected"));setSelections(this);TrackFeature("Variables->"+getPanelHeading(this)+"->Select All Dimensions")});$("body").on("click",".unselectAll",function(){var t=$(this).parents(".panel").find(".availableView").attr("data-value"),i=$("#tbl_"+t).attr("data-type"),n;gblselectionChanged[t]=!0;gbl_high_freequencyenabled==!0&&i=="T"?($(this).parents(".panel").find("#hfvariableList:visible .tabcontent:visible .availableView .chkSelectElement").prop("checked",!1),$(this).parents(".panel").find("#hfvariableList:visible .tabcontent:visible .availableView li").removeClass("selected")):gbl_SubnationalFilter&&i=="C"?(n=$(".variableList").find(".tabcontent:visible").attr("id"),$(".variableList").find("#"+n).find(".chkSelectElement").prop("checked",!1),$(".variableList").find("#"+n).find(".chkSelectElement").trigger("change")):($(this).parents(".panel").find(".availableView .chkSelectElement").prop("checked",!1),$(this).parents(".panel").find(".availableView li").removeClass("selected"));removecustomvariables(this);setSelections(this);TrackFeature("Variables->"+getPanelHeading(this)+"->UnSelect All Dimensions")});$("body").on("click",".invertSelection",function(){var n,t=$(this).parents(".panel").find(".availableView").attr("data-value"),i=$("#tbl_"+t).attr("data-type"),r;gblselectionChanged[t]=!0;gbl_high_freequencyenabled==!0&&$("#tbl_"+t).attr("data-type")=="T"?n=$(this).parents(".panel").find("#hfvariableList:visible .tabcontent:visible .availableView .chkSelectElement"):gbl_SubnationalFilter&&i=="C"?(r=$(".variableList").find(".tabcontent:visible").attr("id"),n=$(".variableList").find("#"+r).find(".chkSelectElement")):n=$(this).parents(".panel").find(".availableView .chkSelectElement");n.each(function(){$(this).is(":checked")?($(this).prop("checked",!1),$(this).parents("li").removeClass("selected"),gbl_SubnationalFilter&&i=="C"&&$(this).trigger("change")):($(this).prop("checked",!0),$(this).parents("li").addClass("selected"),gbl_SubnationalFilter&&i=="C"&&$(this).trigger("change"))});setSelections(this);TrackFeature("Variables->"+getPanelHeading(this)+"->Inverse Selection")});$("body").on("click",".removeAll",function(){var t=confirm("Are you sure you want to clear selections for this panel?"),n;t&&(n=$(this).parents(".panel").find("ul.selectedView").attr("data-type"),$(this).parents(".panel").find(".noVariableTxt").show(),gbl_SubnationalFilter&&n=="C"?$(this).parents(".panel").find(".SubnationalAvailableView li").removeClass("selected"):$(this).parents(".panel").find(".availableView li").removeClass("selected"),$(this).parents(".panel").find(".chkSelectElement").prop("checked",!1),removecustomvariables(this),setSelections(this),TrackFeature("Variables->"+getPanelHeading(this)+"->Remove Selection"))})}function initSelectMembers(){$(".variableTable").on("click",".chkSelectElement",function(){var i=$(this).parents(".panel").find("ul.selectedView").attr("data-type"),n,t=$(this).prop("checked");t?($(this).parents("li").addClass("selected"),n="Select"):($(this).parents("li").removeClass("selected"),n="UnSelect");setSelectionChange(this);TrackFeature(getPanelHeading(this)+"->"+n+" dimension")});$(".SubnationalAvailableView").on("click",".chkSelectElement",function(){var t=$(this).parents(".panel").find("ul.selectedView").attr("data-type"),n=$(this).prop("checked");n?(selectText="Select",$(this).parents("li").addClass("selected")):($(this).parents("li").removeClass("selected"),selectText="UnSelect");setSelectionChange(this);TrackFeature(getPanelHeading(this)+"->"+selectText+" dimension")});$("#tb-indicatorAggRule").on("click","select,input",function(){$(".selectionModifyTxt").show();$("#faded").show();$(".downloadMsg").is(":visible")&&$(".downloadMsg").hide()});$("#divApplyAll").on("click","select,input",function(){$(".selectionModifyTxt").show();$("#faded").show();$(".downloadMsg").is(":visible")&&$(".downloadMsg").hide()})}function buildSelectFilter(n){$("#divMap"+n).hasClass("collapse")&&($("#report-loading").show(),$.ajax({type:"POST",async:!0,url:gbl_basepath+"AjaxServices/AjaxReportMethods.asmx/GetModalMapFilter",contentType:"application/json; charset=utf-8",data:"{filtertype: '"+n+"'}",dataType:"html",success:function(t){var i=$.parseJSON(t).d;$("#divMap"+n).html(i);$(".select-filter-check").off("click");$(".select-filter-check").on("click",function(){loadSelectFilterItems(this)});$("#report-loading").hide()},error:function(){$("#report-loading").hide();window.location.href=gbl_error_file}}))}function initMetadataView(){$("#liMetadata").off("click");$("#liMetadata").on("click",function(){if(hasclearedallselections(!1))return!1;$("#metadataReportVariables").show();$("#liStyles").hide();$("#liLayout").addClass("group1");$("#liEmbed").hasClass("active")&&$("#liLayout a").trigger("click")});$("#liTable, #liChart, #liMap").off("click");$("#liTable, #liChart, #liMap").on("click",function(){if(hasclearedallselections(!1))return!1;$("#metadataReportVariables").hide();$("#liStyles").show();$("#liLayout").removeClass("group1");$("#liEmbed").hasClass("active")&&$("#liLayout a").trigger("click")})}function loadMetaDataVariable(n,t,i,r){var f='<div style="width: 100%; text-align: center;">'+$("#report-loading").html()+"<div>",u;$("#divMetadataCtl div.modal-body").html(f);$("#divMetadataCtl").attr("selection","variable");u=$("#hdnCubeID").val();$.ajax({type:"POST",url:gbl_report_methods+"/PopulateMetaDataJSON_SV",contentType:"application/json; charset=utf-8",data:"{cubeid: '"+u+"', name:'"+n.replace(/\'/g,"%27")+"', code:'"+t+"', dimensiontype:'"+i+"', dimensionname: '"+r+"', lang:'"+gbl_common_culture+"'}",dataType:"json",success:function(r){r.d!=null&&r.d!=""&&($("#divMetadataCtl div.modal-body").html(r.d),$("#gdp-meta-data-rpt").length>0?$("#gdp-meta-data-rpt").css("max-height",Math.round($(window).height()*.5)+"px").css("overflow","auto"):($("#gdp-meta-data").css("max-height",Math.round($(window).height()*.5)+"px").css("overflow","auto"),$("#gdp-meta-data #metadata-specific-data").css("max-height","").css("overflow","")),$("#divMetadataCtl .btn-meta-download").show(),gbl_download_name=n,gbl_download_code=t,gbl_download_type=i)},error:function(){window.location.href=gbl_error_file}})}function loadSelectedDBList(n){var t=$(n).parents(".panel-heading").find(".panel-title a")[0];loadDatabaseList(t)}function loadAvailableDBList(n){var t=$(n).parents(".panel-heading").find(".panel-title a")[0];loadDatabaseList(t)}function loadDatabaseList(n){var u;if(n!=null&&!$(n).hasClass("collapsed")){$(n).parents(".panel-heading").find(".toggleSelectionViews a").removeClass("active");return}TrackFeature("Variables->Database");$("#report-loading").show();var t="DBList",i="All",r=gbl_array_data[t+"_"+i];r==null?(gbl_array_data[t+"_"+i]="Loading",u=new Date,$.ajax({type:"POST",async:!0,url:gbl_report_methods+"/GetDatabaseListJSON",contentType:"application/json; charset=utf-8",data:"{}",dataType:"json",success:function(n){gbl_array_data[t+"_"+i]=n.d;createDatabaseList(t,i);$("#report-loading").hide();initDragDrop()},error:function(){gbl_array_data[t+"_"+i]=null;$("#report-loading").hide();window.location.href=gbl_error_file}})):(n==null&&createDatabaseList(t,i),$("#report-loading").hide())}function createDatabaseList(n,t){var r="#tbl_"+n,i=gbl_array_data[n+"_"+t];i!=null&&(gbl_array_member_selected[n]==null&&(gbl_array_member_selected[n]=i.Sel,GenarateAdobeDimensions(n)),loadFilter(n,t,r,!1,i.Levels),loadDimMembers(n,r,!1,i.Members,i.JTL,!1),getSelectedMembers(n,r))}function loadDatabaseDetails(n){var t='<div style="width: 100%; text-align: center;">'+$("#report-loading").html()+"<div>";$("#dbMetadata div.modal-body").html(t);$.ajax({type:"POST",url:gbl_report_methods+"/PopulateDatabaseDetails",contentType:"application/json; charset=utf-8",data:"{cubeid:'"+n+"', lang:'"+gbl_common_culture+"'}",dataType:"json",success:function(n){n.d!==null&&n.d!==""&&(n.d=n.d.replace(/&lt;/g,"<"),n.d=n.d.replace(/&gt;/g,">"),$("#dbMetadata div.modal-body").html(n.d))},error:function(){window.location.href=gbl_error_file}})}function addCustomMember(n,t,i,r,u,f,e){var s=i.displayname,o;return $(t).parent().find(".selectedView li[uniqueId='custom_"+s+"']").length<=0&&(o="<li class='selected' uniqueid='custom_"+s+"'",i.customdefinition!=null&&i.customdefinition.formulaname!=null&&(o+=" formulaname='"+i.customdefinition.formulaname+"' "),o+="> ",f&&(o+="<span class='glyphicon glyphicon-plus-sign plusIcon'><\/span> "),o+="<span class='deleteIcon glyphicon glyphicon-remove-circle'><\/span>  ",o+="<span class='value'>"+s+"<\/span>  ",o+="<a href='javascript:void(0)'  class='editLnk'onclick=\""+u+"('"+n+"', '"+s+"')\">Edit<\/a><\/li>",r&&$(t).parent().find(".selectedView").append(o),i.customdefinition!=null&&i.customdefinition.periods!=null&&i.customdefinition.periods.length>0&&($tblavailable=$("#tbl_"+n),$.each(i.customdefinition.periods,function(n,t){$tblavailable.find("input[id='chk"+t.uniquename+"']").prop({checked:!0}).attr("disabled",!0)}))),e!=""&&alert("New Custom "+e+" added sucessfully."),o}function addCustomPeriod(n){var o,s,h,c,l;gbl_array_member_selected[n]==null&&(gbl_array_member_selected[n]={},GenarateAdobeDimensions(n));var i=gbl_array_member_selected[n],e=$("#selPeriodFunctionType").val(),u=$("#txtTimeFunctionName").val().trim(),p=$("#selCustomTime_From").val(),w=$("#selCustomTime_To").val(),b=$("#txtTimeMetadata").val(),k=$("#chkTimeDisplayDef").prop("checked"),a=$("#selMRVOrder").val(),v=$("#txtMRVLabel").val().trim(),y=$("#chkTimeHideTitle").prop("checked"),d=$("#chkTimeHideLabel").prop("checked"),g=$("#selCustomTime_From option:selected").text(),nt=$("#selCustomTime_To option:selected").text(),f={},t={},r=null;if(u==""){alert("Please enter function title.");return}if(r=i["custom_"+u],r==null||confirm("Custom Period already exists. Do you want to overwrite?")){if(f.displayname=u,f.custom=!0,t.functiontype=e,e=="DynYear"){if(o=$.grep(Object.keys(i),function(n){return i[n].custom==!0&&i[n].customdefinition!=null&&i[n].customdefinition.functiontype.toLowerCase()=="dynyear"}),o.length>0&&i[o[0]].displayname!=u){alert("Only one dynamic period is allowed");return}if(s=$("#selDynPeriodTotal").val(),h=$("#selDynPeriodLatest").val(),t.totalperiod=s,t.latestperiod=h,$("#report-loading").show(),c=!1,$.ajax({type:"POST",async:!1,url:gbl_report_methods+"/PopulateDynamicYears",contentType:"application/json; charset=utf-8",data:"{controlid: '"+n+"', totalperiods: '"+s+"', latestperiods: '"+h+"'}",dataType:"json",success:function(i){t.periods=i.d;$tblavailable=$("#tbl_"+n);r!=null&&r.customdefinition!=null&&r.customdefinition.periods!=null&&$.each(r.customdefinition.periods,function(n,t){$tblavailable.find("input[id='chk"+t.uniquename+"']").prop({checked:!1}).removeAttr("disabled")});$.each(i.d,function(n,t){$tblavailable.find("input[id='chk"+t.uniquename+"']").prop("checked")&&$tblavailable.find("input[id='chk"+t.uniquename+"']").trigger("click");$tblavailable.find("input[id='chk"+t.uniquename+"']").prop({checked:!0}).attr("disabled",!0)});c=!0;$("#report-loading").hide()},error:function(){$("#report-loading").hide();window.location.href=gbl_error_file}}),!c)return}else{t.uname_from=p;t.uname_to=w;t.year_from=g;t.year_to=nt;t.metainfo=htmlEncode(b);t.displaydef=k;switch(e){case"MRV":t.mrvorder=a;t.mrv_hidetitle=y;break;case"MRVRight":case"MRVLeft":if(v==""){alert("Please enter MRV Label");return}t.mrvorder=a;t.mrvlabel=v;t.mrv_hidetitle=y;t.mrv_hidelabel=d}}f.customdefinition=t;i["custom_"+u]=f;GenarateAdobeDimensions(n);l="#tbl_"+n;addCustomMember(n,l,f,!0,"editCustomPeriod",!1,"Period");getSelectedCount(n,l);clearCustomPeriod();showSelectionsChanged(n);TrackFeature("Variables->Add Custom Time Period")}}function editCustomPeriod(n,t){gbl_array_member_selected[n]==null&&(gbl_array_member_selected[n]={},GenarateAdobeDimensions(n));var r=gbl_array_member_selected[n],u=r["custom_"+t],i=u.customdefinition;if($("#txtTimeFunctionName").val(t),$("#selPeriodFunctionType").val(i.functiontype),$("#selPeriodFunctionType").val()=="DynYear")$("#selDynPeriodTotal").val(i.totalperiod),$("#selDynPeriodLatest").val(i.latestperiod);else{$("#selCustomTime_From").val(i.uname_from);$("#selCustomTime_To").val(i.uname_to);$("#txtTimeMetadata").val(htmlDecode(i.metainfo));$("#chkTimeDisplayDef").prop({checked:i.displaydef});switch(i.functiontype){case"MRV":$("#selMRVOrder").val(i.mrvorder);$("#chkTimeHideTitle").prop({checked:i.mrv_hidetitle});break;case"MRVRight":case"MRVLeft":$("#selMRVOrder").val(i.mrvorder);$("#txtMRVLabel").val(i.mrvlabel);$("#chkTimeHideTitle").prop({checked:i.mrv_hidetitle});$("#chkTimeHideLabel").prop({checked:i.mrv_hidelabel})}}$("#selPeriodFunctionType").trigger("change");$("#createTimeFunctionAcc").parents("#zoomModalBody").hasClass("modal-body")&&$("#zoomModalBody").find(".openBtnModal").trigger("click");$('#createTimeFunctionAcc div div.panel-heading a[href="#createTimeFunction"]').hasClass("collapsed")&&$('#createTimeFunctionAcc div div.panel-heading a[href="#createTimeFunction"]').trigger("click");TrackFeature("Variables->Edit Custom Time Period")}function clearCustomPeriod(){$("#txtTimeFunctionName").val("");$("#txtMRVLabel").val("");$("#txtTimeMetadata").val("");$("#chkTimeDisplayDef").prop({checked:!1});$("#chkTimeHideTitle").prop({checked:!1});$("#chkTimeHideLabel").prop({checked:!1});TrackFeature("Variables->Clear Custom Time Period")}function initCustomPeriodSettings(){$("#selPeriodFunctionType").change(function(){var n=$(this).val(),t=$(this).parents(".panel").find(".availableView").attr("data-type");switch(n){case"MRV":$("#rowSpan").show();$("#rowOrder").show();$("#rowLabel").hide();$("#rowDynPeriod").hide();$("#divTimeHideTitle").show();$("#divTimeHideLabel").hide();$("#divTimeAddtOptions").show();break;case"MRVRight":case"MRVLeft":$("#rowSpan").show();$("#rowOrder").show();$("#rowLabel").show();$("#rowDynPeriod").hide();$("#divTimeHideTitle").show();$("#divTimeHideLabel").show();$("#divTimeAddtOptions").show();break;case"DynYear":$("#rowSpan").hide();$("#rowOrder").hide();$("#rowLabel").hide();$("#rowDynPeriod").show();$("#divTimeHideTitle").hide();$("#divTimeHideLabel").hide();$("#divTimeAddtOptions").hide();break;default:$("#rowSpan").show();$("#rowOrder").hide();$("#rowLabel").hide();$("#rowDynPeriod").hide();$("#divTimeHideTitle").hide();$("#divTimeHideLabel").hide();$("#divTimeAddtOptions").show()}TrackFeature("Variables->"+getPanelHeading(this)+"->Create Time Function->Type-> "+n)})}function showSelectionsChanged(n){var i,t;$("#divNoDataToDisplay").is(":hidden")?($("#faded").show(),i=$("#panel_"+n).position(),$(".selectionModifyTxt").show(),$(".downloadMsg").is(":visible")&&$(".downloadMsg").hide(),$(".selectionModifyTxt").attr("panel-id","#panel_"+n)):(t=0,$(".selectionCountRHS").each(function(){var n=eval($(this).text());(n==null||n<1||n=="")&&t++}),t>0?$("#applyChangesNoPreview").addClass("disabled"):$("#applyChangesNoPreview").removeClass("disabled"))}function showVariableDropdown(){$(".toggleDropDown,.dropDownWrapper,.filterTree,.toggleFilter").click(function(n){$(this).hasClass("toggleFilter")&&TrackFeature("Variables->"+getPanelHeading(this)+"->Filter");n.stopPropagation()});$(".toggleDropDown,.dropDownWrapper").click(function(n){n.stopPropagation()})}function show(n){$(n).css("visibility","visible");$(".dropDownWrapper").slideUp()}function hide(n){$(n).css("visibility","hidden")}function cancel(n){$(n).slideUp()}function togglFilter(){$(".toggleDropDown,.toggleFilter").click(function(){$(this).next().slideToggle()})}function openCustomDiv(n,t,i){$(i).is(":checked")?$(t).show():$(t).hide()}function resetVariables(){$("input[type=checkbox],input[type=radio]").removeAttr("checked")}function checkSelectedPageLoad(){$(".chkSelectElement").prop("checked",!1);$(".variableTable li.selected").each(function(){$(this).find(".chkSelectElement").prop("checked",!0)})}function checkSelected(n){oldList=fetchOldSelection(n);$(".chkSelected").each(function(){chkBoxId="#"+$(this).attr("id");var n="#select_"+chkBoxId.split("_")[1];$(chkBoxId).is(":checked")?($(n).prop("checked",!0),$(n).parent().addClass("selected")):($(n).prop("checked",!1),$(n).parent().removeClass("selected"))})}function checkSelectedDb(n){n=n.trim();$("#databaseTable").find("li").removeClass("selected");$("#databaseTable").find(".value").each(function(){if($(this).text().trim()==n)return $(this).parents("li").addClass("selected"),$(this).siblings(".selectDb").prop("checked",!0),!1})}function deleteItem(n){$(n).parent().remove();TrackFeature("Variables->"+getPanelHeading(n)+"->Remove "+$(n).parent().text()+" from custom group")}function clearField(n){$(n).html("");$(n).val("")}function resetCustomGrpSel(){}function populateFormulaDiv(){}function checkBoxSelection(){$(".variableTable").on("click",".selectCountry,.selectSeries",function(){$(this).is(":checked")&&$(this).parent().addClass("selected")})}function populateSelectionList(n,t){$(n).html("");$(t).find(".chkSelectElement").each(function(){if($(this).is(":checked")){var t=$(this).attr("id").split("_")[1],i=selectionItemStr+t+"'/> "+$(this).next().html()+"<\/li>";$(n).append(i)}})}function populateDbSelectionList(){$("#databaseTable").find(".selectDb").each(function(){$(this).is(":checked")&&$("#selectedDb").text($(this).siblings(".value").text().trim())})}function initTreeView(){$(".selector,.masterSelector").prop("checked",!1);$(".masterSelector").on("click",function(){$(this).is(":checked")?$(this).parent().next().find(".selector").prop("checked",!0):$(this).parent().next().find(".selector").prop("checked",!1)});$(".selector").on("click",function(){$(this).is(":checked")?$(this).parents(".childNodes").find(".selector").each(function(){var n=$(this).prop("checked");return n==!0&&$(this).parents(".childNodes").siblings(".parentNode").find(".masterSelector").prop("checked",!0),n==!1?($(this).parents(".childNodes").siblings(".parentNode").find(".masterSelector").prop("checked",!1),!1):void 0}):$(this).parents(".childNodes").siblings(".parentNode").find(".masterSelector").prop("checked",!1)})}function viewToggler(){$(".closeBtn").on("click",function(){$(this).hide();$(".openBtn").show();$(".jqx-splitter-collapse-button-vertical").trigger("click")});$(".openBtn").on("click",function(){$(this).hide();$(".closeBtn").show();$(".jqx-splitter-collapse-button-vertical").trigger("click")});$("#splitter").on("collapsed",function(){$(".tools").hide()});$("#splitter").on("expanded",function(){$(".tools").show()})}function initDragDrop(){$(".variableTable.availableView li").draggable({appendTo:"body",helper:"clone",cursor:"move",cursorAt:{top:0,left:0}});$(".customGroupElements").droppable({activeClass:"ui-state-default",hoverClass:"ui-state-hover",accept:":not(.ui-sortable-helper)",drop:function(n,t){$(this).find(".placeholder").remove();var i="<li><a href='javascript:void(0)' onclick='deleteItem(this)' ><span class='glyphicon glyphicon-remove-circle'><\/span><\/a>"+t.draggable.text()+"<\/li>";$(this).append(i);$("#faded").show();$(".selectionModifyTxt").show();$(".downloadMsg").is(":visible")&&$(".downloadMsg").hide()}}).sortable({items:"li:not(.placeholder)",sort:function(){$(this).removeClass("ui-state-default")}});$("#metadataCountryTable").sortable({revert:!0});$("#metadataAttrTable").sortable({revert:!0});$("body").on("click","#chartOrientationOption",function(){$("#chartCustomOrientationList").sortable({revert:!0})})}function addSelectedClass(){$("#databaseTable").on("click",".selectDb",function(){$("#databaseTable").find("li").removeClass("selected");var n=$(this).prop("checked");n?$(this).parents("li").addClass("selected"):$(this).parents("li").removeClass("selected")})}function hideOnDocClick(){$(document).click(function(){$(".dropDownWrapper,.filterTree").hide()})}function toggleSelectionView(){$("body").on("click",".expandPanel",function(){if($(this).hasClass("collapsed"))$("#nonMetadataReportVariables").on("shown.bs.collapse",function(){if($(".selectionModifyTxt").is(":visible"))var n=$(".selectionModifyTxt").attr("panel-id"),t=$(n).position()});else{$(this).parents(".panel-heading").find(".showAvailable").removeClass("active");$(this).parents(".panel-heading").find(".showSelected").removeClass("active");$("#nonMetadataReportVariables").on("hidden.bs.collapse",function(){if($(".selectionModifyTxt").is(":visible"))var n=$(".selectionModifyTxt").attr("panel-id"),t=$(n).position()})}});$(".panel.panel-default").on("click",".showAvailable",function(){if($(this).parents(".panel.panel-default").find(".selectedView").hide(),$(this).parents(".panel").find(".availableView").show(),$(this).parents(".panel").find(".SubnationalAvailableView").show(),$(this).parents(".panel").find(".availableViewTools").show(),$(this).parents(".panel").find(".selectedViewTools").hide(),$(this).parents(".panel.panel-default").find(".dimensionHolderInner").removeClass("variableTableSelectionView"),$(".panel-title.pull-left.main-title-panel a").addClass("collapsed"),$(".selectedDimensionPanel").removeClass("in").addClass("collapse"),$(".showAvailable,.showAvailableMeta").removeClass("active"),$(this).addClass("active"),$(".showSelected,.showSelectedMeta").removeClass("active"),$(this).parents(".panel").find(".panel-title a").hasClass("collapsed")){$(this).parents(".panel").find(".panel-title a").removeClass("collapsed");$(this).parents(".panel").find(".selectedDimensionPanel").removeClass("collapse").addClass("in");$(this).parents(".panel").find(".selectedDimensionPanel").css("height","auto");return}});$("#zoomModalHeader").on("click",".showAvailable",function(){$("#zoomModalHeader").find(".showSelected").removeClass("active");$(this).addClass("active");$(this).parents("#zoomModalHeader").siblings("#zoomModalBody").find(".selectedView").hide();$(this).parents("#zoomModalHeader").siblings("#zoomModalBody").find(".SubnationalAvailableView").show();$(this).parents("#zoomModalHeader").siblings("#zoomModalBody").find(".availableView").show();$(this).parents(".modal-content").find(".dimensionHolderInner").removeClass("variableTableSelectionView");$(this).parents("#zoomModalHeader").siblings("#zoomModalBody").find(".availableViewTools").show();$(this).parents("#zoomModalHeader").siblings("#zoomModalBody").find(".selectedViewTools").hide()});$("#zoomModalHeader").on("click",".showSelected",function(){$("#zoomModalHeader").find(".showAvailable").removeClass("active");$(this).addClass("active");$(this).parents("#zoomModalHeader").siblings("#zoomModalBody").find(".SubnationalAvailableView").hide();$(this).parents("#zoomModalHeader").siblings("#zoomModalBody").find(".availableView").hide();$(this).parents("#zoomModalHeader").siblings("#zoomModalBody").find(".selectedView").show(function(){$(this).parents(".panel").find("#ascendingChkBox").prop("checked")||$(this).parents(".panel").find(".selectedView").sortable({revert:!0,stop:function(){$(".selectionModifyTxt").show();$("#faded").show();$(".downloadMsg").is(":visible")&&$(".downloadMsg").hide()}});myhelper=function(n){return $("span",$(n)).text()};$("body").on("click",".sort.asc",function(){sortAllSelectedItems($(this).parents(".panel").find(".selectedView"),!0);$(this).removeClass("asc").addClass("desc");$("#divNoDataToDisplay").is(":hidden")&&($("#faded").show(),$(".selectionModifyTxt").show());TrackFeature("Variables->"+getPanelHeading(this)+"->Sort Selection")});$("body").on("click",".sort.desc",function(){sortAllSelectedItems($(this).parents(".panel").find(".selectedView"),!1);$(this).removeClass("desc").addClass("asc");$("#divNoDataToDisplay").is(":hidden")&&($("#faded").show(),$(".selectionModifyTxt").show());TrackFeature("Variables->"+getPanelHeading(this)+"->Sort Selection")});$("body").on("click",".deleteIcon",function(){var n=$(this).parents("li").attr("uniqueid"),i=$(this).parents("ul.selectedView").attr("data-type"),t;n.indexOf("custom_")<0&&(gbl_SubnationalFilter&&i=="C"?($(this).parents(".panel").find(".SubnationalAvailableView li[uniqueid='"+n+"']").removeClass("selected"),$(this).parents(".panel").find(".SubnationalAvailableView li[uniqueid='"+n+"']").find(".chkSelectElement").prop("checked",!1)):($(this).parents(".panel").find(".availableView li[uniqueid='"+n+"']").removeClass("selected"),$(this).parents(".panel").find(".availableView li[uniqueid='"+n+"']").find(".chkSelectElement").prop("checked",!1)));setSelectionChangeEx(this,!1,".selectedView");$(this).parents("li").remove();t=$(this).parents("li").children("span.value").prop("innerText");TrackFeature("Variables->"+getPanelHeading(this)+"->Remove selection->"+t)})});$(this).parents(".modal-content").find(".dimensionHolderInner").addClass("variableTableSelectionView");$(this).parents("#zoomModalHeader").siblings("#zoomModalBody").find(".availableViewTools").hide();$(this).parents("#zoomModalHeader").siblings("#zoomModalBody").find(".selectedViewTools").show()});$(".panel.panel-default").on("click",".showSelected",function(){if($(".panel-title.pull-left.main-title-panel a").addClass("collapsed"),$(".selectedDimensionPanel").removeClass("in").addClass("collapse"),$(this).parents(".panel").find(".availableView").hide(),$(this).parents(".panel").find(".SubnationalAvailableView").hide(),$(this).parents(".panel").find(".availableViewTools").hide(),$(this).parents(".panel").find(".selectedViewTools").show(),$(this).parents(".panel").find(".selectedView").show(function(){$(this).parents(".panel").find("#ascendingChkBox").prop("checked")||$(this).parents(".panel").find(".selectedView").sortable({revert:!0,stop:function(){$(".selectionModifyTxt").show();$("#faded").show();$(".downloadMsg").is(":visible")&&$(".downloadMsg").hide()}});myhelper=function(n){return $("span",$(n)).text()};$("body").on("click",".sort.asc",function(){sortAllSelectedItems($(this).parents(".panel").find(".selectedView"),!0);$(this).removeClass("asc").addClass("desc");$("#divNoDataToDisplay").is(":hidden")&&($("#faded").show(),$(".selectionModifyTxt").show());TrackFeature("Variables->"+getPanelHeading(this)+"->Sort Selection")});$("body").on("click",".sort.desc",function(){sortAllSelectedItems($(this).parents(".panel").find(".selectedView"),!1);$(this).removeClass("desc").addClass("asc");$("#divNoDataToDisplay").is(":hidden")&&($("#faded").show(),$(".selectionModifyTxt").show());TrackFeature("Variables->"+getPanelHeading(this)+"->Sort Selection")});$("body").on("click",".deleteIcon",function(){var n=$(this).parents("li").attr("uniqueid"),t=$(this).parents("ul.selectedView").attr("data-type");n.indexOf("custom_")<0&&(gbl_SubnationalFilter&&t=="C"&&($(this).parents(".panel").find(".SubnationalAvailableView li[uniqueid='"+n+"']").removeClass("selected"),$(this).parents(".panel").find(".SubnationalAvailableView li[uniqueid='"+n+"']").find(".chkSelectElement").prop("checked",!1)),$(this).parents(".panel").find(".availableView li[uniqueid='"+n+"']").removeClass("selected"),$(this).parents(".panel").find(".availableView li[uniqueid='"+n+"']").find(".chkSelectElement").prop("checked",!1));setSelectionChangeEx(this,!1,".selectedView");$(this).parents("li").remove()})}),$(this).parents(".panel.panel-default").find(".dimensionHolderInner").addClass("variableTableSelectionView"),$(".showSelected, .showSelectedMeta").removeClass("active"),$(this).addClass("active"),$(".showAvailable,.showAvailableMeta").removeClass("active"),$(this).parents(".panel").find(".panel-title a").hasClass("collapsed")){$(this).parents(".panel").find(".panel-title a").removeClass("collapsed");$(this).parents(".panel").find(".selectedDimensionPanel").removeClass("collapse").addClass("in");$(this).parents(".panel").find(".selectedDimensionPanel").css("height","auto");return}});$("body").on("click","#ascendingChkBox",function(){if($(this).prop("checked")){$(this).parents(".panel").find(".selectedView").sortable("disable");myhelper=function(n){return $("span",$(n)).text()};var n=$(this).parents(".panel").find(".availableView").attr("data-value");sortTimeAscending($(this).parents(".panel").find("#timedimvariableList .selectedView"))}else $(this).parents(".panel").find(".selectedView").sortable({revert:!1,stop:function(){$(".selectionModifyTxt").show();$("#faded").show();$(".downloadMsg").is(":visible")&&$(".downloadMsg").hide()}})})}function showAvailableSelectedView(){$("#selection").on("click",".panel-title a",function(){$(".showAvailable").removeClass("active");$(".showSelected").removeClass("active");$(this).parents(".panel").find(".availableView").show();$(this).parents(".panel").find(".selectedView").hide();$(this).parents(".panel").find(".availableViewTools").show();$(this).parents(".panel").find(".selectedViewTools").hide();$(this).parents(".panel").find(".showAvailable").addClass("active");$(this).parents(".panel").find(".showAvailableMeta").addClass("active")})}function showPlusIconOnExpand(){$(".changeIcon").on("show.bs.collapse",function(){$(this).parents(".panel").find(".variableTable").addClass("customGroupView");$(this).parents(".panel").find(".SubnationalAvailableView").addClass("customGroupView")});$(".changeIcon").on("hide.bs.collapse",function(){$(this).parents(".panel").find(".variableTable").removeClass("customGroupView");$(this).parents(".panel").find(".SubnationalAvailableView").removeClass("customGroupView")})}function radioBtnTab(){$("body").on("click",".radioBtnTabs",function(){var n="#"+$(this).attr("data-target");$(this).parents(".btn-group").siblings(".radioTabContentWrapper").find(".radioTabContent").hide();$(n).show()});$("body").on("click",".radioBtnTabsInner",function(){dimtype=$(this).parents(".panel").find(".availableView").attr("data-type");var n="#"+$(this).attr("data-target");$(this).parents(".btn-group-inner").siblings(".radioTabContentInner").hide();$(n).show();n=="#divApplyAll"?TrackFeature("Variables->"+getPanelHeading(this)+"->Define Aggreagation Rule->Apply Same rule for all indicators"):n=="#divChooseForAll"&&TrackFeature("Variables->"+getPanelHeading(this)+"->Define Aggreagation Rule->Set rule for each indicator")})}function appendIndicator(){var n="";$("#seriesTable li.selected").each(function(){var t=$(this).find(".value").text();n=n+"<tr><td>"+t+"<\/td>\n<td><select><option>None<\/option><option>Mean<\/option> <option>Median<\/option><option>Min<\/option> <option>Sum<\/option><\/select><\/td>\n<td><select><option>None<\/option><\/select><\/td>\n<td> <input type='text' class='form-control' /><\/td><\/tr>"});$("#tb-indicatorAggRule tbody").html(n)}function getHeaderFooterHeight(){var n=$("#bannerStrip").outerHeight();return n+=$(".language ul li").length>0?$(".language").outerHeight():0,n+=$(".secondaryHeader").outerHeight(),n+=$(".footerStrip").outerHeight(),n+16}function positionElements(){var n=$(window).height(),f=$(window).width(),i=n-130;$(".preview").css("min-height",i+"px");$(".colTools").css("min-height",n-getHeaderFooterHeight()+"px");$(".reportPlaceholder").css("width",$(".colCanvas").width()-45+"px");var t=$(".colCanvas").offset(),r=t.left,u=t.top;$("#fixedLayout").css({top:u,left:r})}function showToolTip(){$(".showToolTip").tooltip({placement:"bottom"});gbl_common_culture=="ar"?($(".toolTipLeft").tooltip({placement:"left"}),$(".toolTipRight").tooltip({placement:"right"})):($(".toolTipLeft").tooltip({placement:"right"}),$(".toolTipRight").tooltip({placement:"left"}))}function initAutoCompleteVar(n,t,i){var r=new $.jqx.dataAdapter(t);$(n).jqxInput({placeHolder:"Search",height:24,width:"85%",minLength:1,source:r,displayMember:i,items:8})}function initSlider(n,t){$("#slider-range").slider({range:!0,min:n,max:t,values:[n,t],slide:function(){},stop:function(n,t){var f,e;$(this).parents(".variableListWrapper").find(".searchResults").show();f=$("#slider-range").slider("values",0);e=$("#slider-range").slider("values",1);gbl_start_var_time=1;gbl_end_var_time=threshold;var i=$(this).attr("data-source"),r=$(this).attr("target-id"),u=timeDimArray;gbl_high_freequencyenabled==!0&&$("#tbl_"+i).attr("data-type")=="T"&&(i=GetHighFrequencyControlId(i),r=GetHighFrequencyTargetId(r),u=GetHighFrequencyDataSource());LoadSlider(i,r,u,t)}})}function LoadSlider(n,t,i,r){var u=[],e={dataType:"json",dataFields:[{name:"ID",type:"string"},{name:"Code",type:"string"},{name:"Name",type:"string"},{name:"JTC",type:"string"},{name:"SM",type:"boolean"}],localdata:i},f=new $.jqx.dataAdapter(e,{loadComplete:function(n){for(var n=f.records,i=n.length,n=n.reverse(),t=r.values[0]-1;t<r.values[1];t++)u.push(n[t]),t==r.values[0]-1&&(startText=n[t].Name),t==r.values[1]-1&&(endText=n[t].Name);$("#year").text(endText+" - "+startText)}});f.dataBind();u.reverse();stringBuilder_Time(n,t,!1,u)}function getSelected(n,t){for(var i=0;i<n.length;i++)switch(n[i].datalevel){case"1":if(n[i].datavalue==t.Level1Code)return!0;break;case"2":if(n[i].datavalue==t.Level2Code)return!0;break;case"3":if(n[i].datavalue==t.Level3Code)return!0;break;case"4":if(n[i].datavalue==t.Level4Code)return!0}return!1}function getMemberList(n){var t="";$.each(n,function(n,i){t+="<li>";t+='<a data-toggle="modal" data-target="#seriesMetaDataModal"><span class="glyphicon glyphicon-eye-open metadataIcon sprite icon-info"><\/span><\/a>';t+='<span class="glyphicon glyphicon-plus-sign plusIcon"><\/span>';t+='<input type="checkbox" id="select_ind_'+i.IndicatorCode+'" class="chkSelectElement" />';t+='<span class="value">'+i.IndicatorName+"<\/span>";t+="<\/li>"});$("#seriesTable").html(t)}function getFilterLevels(n){var t="<li>";switch(n.Level){case 1:t+='<div class="parentNode">';t+="<span class='toggleList'><\/span>";t+='<input type="checkbox" class="masterSelector filter-check" data-value="'+n.UniqueID+'" data-level="'+n.Level+'" />'+n.Name+"<\/div>";break;case 2:case 3:case 4:t+='<input type="checkbox" class="selector filter-check" data-value="'+n.UniqueID+'" data-level="'+n.Level+'" />'+n.Name}return n.Hierarchies.length>0&&(t+='<ul class="childNodes level'+n.Level+'">',$.each(n.Hierarchies,function(n,i){t+=getFilterLevels(i)}),t+="<\/ul>"),t+="<\/li>"}function viewRecentYears(){}function cloneDivs(){$("body").on("click",".closeZoomModal",function(){var n=$(this).attr("destination_panel"),i=$(n).find(".dimensionHolder"),r,t;$("#zoomModalBody .dimensionHolderInner").appendTo(i);r=$(n).find(".variableTable li.selected").length;t=$(n).siblings(".panel-heading").find(".statsWrapper");$("#zoomModalHeader .statsInner").appendTo(t);$(n).find(".variableList").css("max-height","250px");$(n).find(".modal-leftCol").css({width:"100%"});$(n).find(".modal-rightCol").css({width:"100%"});$(n).find(".modal-rightCol").show();$("#ul-addMoreDimension").appendTo(".addRemoveVariables");$(".addMoreHiddenDiv").show();listUnselectedVariables(!1);$("#faded").hide()});$("body").on("click",".zoom",function(){var r,i,n,u,s,f,e,t,o;$(".addMoreHiddenDiv").show();$(".closeZoomModal").attr("destination_panel",r);r=$(this).attr("destination_panel");i=$(this).attr("target_panel");$(this).parents("#zoomModalHeader").hasClass("modal-header")&&(n=$(".closeZoomModal").attr("destination_panel"),u=$(n).find(".dimensionHolder"),$("#zoomModalBody .dimensionHolderInner").appendTo(u),s=$(n).find(".variableTable li.selected").length,f=$(n).siblings(".panel-heading").find(".statsWrapper"),$("#zoomModalHeader .statsInner").appendTo(f),$(n).find(".variableList").css("max-height","250px"),$(n).find(".modal-leftCol").css({width:"100%"}),$(n).find(".modal-rightCol").css({width:"100%"}),$(n).find(".modal-rightCol").show(),$("#ul-addMoreDimension").appendTo(".addRemoveVariables"));$(".closeZoomModal").attr("destination_panel",r);$("#ul-addMoreDimension").appendTo("#zoomModalHeader");$(i).find(".statsInner").appendTo("#zoomModalHeader");e=$(this).attr("target_panel");t=$(e+" .panel-heading h4.panel-title a").text();t==null&&(t="");t=t.trim();$(i).find(".dimensionHolderInner").appendTo("#zoomModalBody");$("#zoomModalBody").attr("destination-panel",i);$("#zoomModalBody").css("height",$(window).height()-200);$("#zoomModalBody .variableList").css("max-height",$(window).height()-315);$("#zoomModalBody .variableTable").hasClass("table-dimension-T")&&$("#zoomModalBody .variableList").css("max-height",$(window).height()-390);$("#zoomModalTitle").text(t);$("#zoomModalBody").find(".variableTable.availableView").hasClass("customGroupView")?($("#zoomModalBody").find(".modal-leftCol").css("width","70%"),$("#zoomModalBody").find(".modal-rightCol").css("width","25%"),$("#zoomModalBody").find(".modal-rightCol").show(),$("#zoomModalBody").find(".closeBtnModal").show(),$("#zoomModalBody").find(".openBtnModal").show(),$(this).attr("destination_type")=="M"&&($("#zoomModalBody .viewToggler.openBtnModal").hide(),$("#zoomModalBody .viewToggler.closeBtnModal").hide())):($("#zoomModalBody").find(".modal-leftCol").css("width","95%"),$("#zoomModalBody").find(".modal-rightCol").hide(),$("#zoomModalBody").find(".closeBtnModal").hide(),$("#zoomModalBody").find(".openBtnModal").show(),$(this).attr("destination_type")=="T"&&$("#zoomModalBody").find(".openBtnModal").show());o=$(this).attr("parent-li");$(o).hide();$("#zoomModalBody .variableTable").css("max-height",$(window).height()-315);adjustVariableListWidth();$("#zoomModalBody .tree").css("max-height",$(window).height()-330);TrackFeature("Variables->"+getPanelHeading(this)+"->Open Zoom out window")});$("#zoomView").on("shown.bs.modal",function(){$("#zoomModalBody .variableList").css("max-height",$(window).height()-315);$("#zoomModalBody .variableTable").hasClass("table-dimension-T")&&$("#zoomModalBody .variableList").css("max-height",$(window).height()-345);$("#zoomModalBody .tree").css("max-height",$(window).height()-330);adjustVariableListWidth()});$("#zoomView").on("hidden.bs.modal",function(){$(".variableList").css("max-height","");$(".variableList").width("100%");$(".tree").css("max-height","")})}function adjustVariableListWidth(){($("#zoomModalBody .variableTable").attr("data-type")=="S"||$("#zoomModalBody .variableTable").attr("data-type")=="C"||$("#zoomModalBody .variableTable").attr("data-type")=="T"&&$("#zoomModalBody .variableTable").attr("data-type")=="O")&&$("#zoomModalBody").find(".variableList").width($("#zoomModalBody .modal-leftCol").width()-$("#zoomModalBody").find(".filterTree").width()-5+"px");$("#zoomModalBody .variableTable").attr("data-type")=="T"&&gbl_high_freequencyenabled&&$("#zoomModalBody").find(".variableList")&&$("#zoomModalBody").find(".variableList").width("100%")}function showAdditionalOptions(){$("body").on("click",".showAdditionalOptions",function(){$(this).toggleClass("active");$(this).next().slideToggle()});$("#zoomModalBody").on("click",".openBtnModal",function(){$(this).hide();$(this).siblings(".closeBtnModal").show();$(this).parents(".modal-body").find(".modal-leftCol").css("width","60%");$(this).parents(".modal-body").find(".modal-rightCol").css("width","35%");$(this).parents(".modal-body").find(".modal-rightCol").show();$(this).parents(".modal-body").find(".variableList").addClass("modal-custom-open");adjustVariableListWidth()});$("#zoomModalBody").on("click",".closeBtnModal",function(){$(this).hide();$(this).siblings(".openBtnModal").show();$(this).parents(".modal-body").find(".modal-leftCol").css("width","95%");$(this).parents(".modal-body").find(".modal-rightCol").hide();$(this).parents(".modal-body").find(".variableList").removeClass("modal-custom-open");adjustVariableListWidth()})}function setIframeDimension(){$("#createCustomThemeModal").on("shown.bs.modal",function(){$("#customTableHolder").attr("width",$("#createCustomThemeModal .modal-content").width()-50);$("#customTableHolder").attr("height",$("#createCustomThemeModal .modal-content").height()-100);typeof $("#customTableHolder")[0].contentWindow.adjustFrameHeight==typeof Function&&$("#customTableHolder")[0].contentWindow.adjustFrameHeight()})}function moveAddMoreLinksToRHS(){$(".addMoreHiddenDiv").each(function(){$(this).appendTo("#ul-addMoreDimension")})}function triggerClickOnEnter(){$(".searchInput").keyup(function(n){n.keyCode==13&&$(this).next().click()})}function sortAllSelectedItems(n,t){var i=n.children("li").get(),r=n.attr("data-type");r=="O"?t?i.sort(function(n,t){var i=$(n).attr("uniqueid"),r=$(t).attr("uniqueid");return i<r?-1:i>r?1:0}):i.sort(function(n,t){var i=$(n).attr("uniqueid"),r=$(t).attr("uniqueid");return i>r?-1:i<r?1:0}):t?i.sort(function(n,t){var i,u;return gbl_high_freequencyenabled&&r=="T"?(i=$(n).attr("orderby"),u=$(t).attr("orderby")):(i=$(n).find("span.value").text().toUpperCase(),u=$(t).find("span.value").text().toUpperCase()),i<u?-1:i>u?1:0}):i.sort(function(n,t){var i,u;return gbl_high_freequencyenabled&&r=="T"?(i=$(n).attr("orderby"),u=$(t).attr("orderby")):(i=$(n).find("span.value").text().toUpperCase(),u=$(t).find("span.value").text().toUpperCase()),i>u?-1:i<u?1:0});$.each(i,function(t,i){n.append(i)})}function sortTimeAscending(n){var t=n.children("li").get();t.sort(function(n,t){var i=$(n).find("span.value").text().toUpperCase(),r=$(t).find("span.value").text().toUpperCase();return i<r?-1:i>r?1:0});$.each(t,function(t,i){n.append(i)})}function createPagerDropdown(n,t){for(var u=t.length,f=Math.ceil(u/threshold),r="",i=1;i<=f;i++)r+="<option>"+i+"<\/option>";$("#goTo_"+n).html("");$("#goTo_"+n).append(r)}function toggleFilterHierarchy(){}function gridRenderingSettings(){$(".dxgvTable_GridDefaultTheme tr:first-child").show();gbl_common_culture=="ar"?$(".dxgvFCSD").scrollLeft("0"):$(".dxgvFCSD").scrollLeft($(".dxgvFCSD div").width())}function showSubnationals(n,t,i){$("#newSelection_"+n+" #SubNAtionalButtonGrp").show();$("#CtryAgg_Classification_"+n).hide();$(".SubnationalAvailableView").show();CreateSubNationalTabs(t.Members,n,t.Levels,i);$("body").on("click",".SubnationalAvailableView li span.bookunit",function(){var r=$(this).parents(".panel").find("ul.selectedView").attr("data-type"),t=$($(this).parent("li")).children("span.caret-n");t!==null&&r==="C"&&gbl_SubnationalFilter&&ShowSubnationalList(t,n,i)});$("body").on("click",".caret-n",function(){var r=$(this).parents(".panel").find("ul.selectedView").attr("data-type"),t;(r="C"&&gbl_SubnationalFilter)?ShowSubnationalList($(this),n,i):(t=$(this).parents(".national").attr("parent"),$(this).toggleClass("caret-n-open"),$(".subnational[child='"+t+"']").toggle(),$(this).parents(".national").find(".nationalName").toggle())});$("body").on("click",".selectAllSub",function(){var n=$(this).parents(".national").attr("parent");$(".subnational[child='"+n+"']").find(".chkSelectElement").prop("checked",!1);$(".subnational[child='"+n+"']").find(".chkSelectElement").trigger("click");$(this).parents(".national").find(".chkSelectElement").prop("checked",!1);$(this).parents(".national").find(".chkSelectElement").trigger("click");$(this).parents(".national").find(".closed").hasClass("caret-n-open")||$(this).parents(".national").find(".closed").trigger("click")});$("body").on("click",".unselectAllSub",function(){var n=$(this).parents(".national").attr("parent");$(".subnational[child='"+n+"']").find(".chkSelectElement").prop("checked",!0);$(".subnational[child='"+n+"']").find(".chkSelectElement").trigger("click");$(this).parents(".national").find(".chkSelectElement").prop("checked",!0);$(this).parents(".national").find(".chkSelectElement").trigger("click");$(this).parents(".national").find(".closed").hasClass("caret-n-open")||$(this).parents(".national").find(".closed").trigger("click")})}function CreateSubNationalTabs(n,t,i,r){var e,u="<div class='btn-group' data-toggle='buttons'>",o="<div id='All' class='tabcontent'><\/div >",f;if(gbl_subnational_singleView)u+="<label style='display:none' data-customlink='sf:body' level= 'All' id = 'defaultSubnationalTab' onclick=\"openSubNationalTab(event, 'All', '"+r+"')\" class='btn active'>",u+="<input type='radio' id='defaultOpen' checked='checked' />All<\/label>",o+="<div id='Level_0' class='tabcontent'><\/div >",u+="<\/div>";else{for(u+="<label data-customlink='sf:body' level= 'All' id = 'defaultSubnationalTab' onclick=\"openSubNationalTab(event, 'All', '"+r+"')\" class='btn active'>",u+="<input type='radio' id='defaultOpen' checked='checked' />All<\/label>",f=0;f<i.length;f++)e=i[f].HN,(e===null||e.trim()===""||e.trim().toUpperCase()==="NULL")&&(e="Level "+f),u+="<label data-customlink='sf:body' level='Level_"+f+"' onclick=\"openSubNationalTab(event, 'Level_"+f+"', '"+r+"')\" class='btn'>",u+="<input type='radio' checked='checked'/>"+e+"<\/label >",o+="<div id='Level_"+f+"' class='tabcontent'><\/div >";u+="<\/div>"}$("#newSelection_"+t+" #SubNAtionalButtonGrp").html(u);$("#newSelection_"+t+" .SubnationalAvailableView").html(o)}function initBookAttributes(){$.ajax({type:"POST",async:!0,url:gbl_report_methods+"/PopulateBookAttributesJSON",contentType:"application/json; charset=utf-8",data:"{}",dataType:"json",success:function(n){gbl_array_book_attributes=eval(n.d)},error:function(){window.location.href=gbl_error_file}})}function validateBookUnits(){var u=!0,n=[],t=[],o=$('.variableTable.selectedView[data-type="S"]').attr("data-value"),s="#tbl_"+o;for($(s).parent().find(".selectedView li").each(function(n,i){t.push($(i).attr("uniqueid"))}),t.length==0&&$.ajax({type:"POST",async:!1,url:gbl_report_methods+"/PopulateSelectedIndicatorsJSON",contentType:"application/json; charset=utf-8",data:"{}",dataType:"json",success:function(n){var i=eval(n.d);for(var r in i)t.push(i[r].uniquename)}}),rowid=0;rowid<t.length;rowid++)n.push($.grep(gbl_array_book_attributes,function(n){return n.seriesId==t[rowid]}));var f=[],r=0,e=0;for(i=0;i<n.length;i++)n[i].length>0?f.indexOf(n[i][0].bookUnit)===-1&&(f.push(n[i][0].bookUnit),r++):e++;return(r>0&&e>0||r>1)&&(u=!1),u}function CloseOpenedTimeSection(){gbl_high_freequencyenabled&&$("div#panel_IFS_Time a[title=Time]")&&($("div#panel_IFS_Time a[title=Time]").hasClass("collapsed")||$("div#panel_IFS_Time a[title=Time]").click())}function LoadCustomTime(n){for(var r,f=n.length,u="",i="",t=0;t<f;t++)r='<option value="'+n[t].ID+'">'+n[t].Name+"<\/option>",u+=r,i=r+i;$("#selCustomTime_From").html(i);$("#selCustomTime_To").html(u)}function GenarateAdobeDimensions(n){if(n){var r=[],i=gbl_array_member_selected[n],t=JSON.parse($("#hdnAbobeText").val());t!==null&&t.Dimensions!==null&&(i===null||i.length===0?t.Dimensions[n]={}:($.each(i,function(n,t){r.push(t.displayname)}),t.Dimensions[n]=r));$("#hdnAbobeText").val(JSON.stringify(t));CreateAdobeText(t)}}var selectionItemStr="<li>  <input type='checkbox' checked='checked' class='chkSelectElement' id='selected_",oldList="",customIndicatorLi="<li class='selected'> <a href='javascript:void(0)' onclick='viewMetaData(this)'><span class='metadataIcon sprite icon-info'><\/span><\/a>  <span class='glyphicon glyphicon-plus-sign plusIcon'><\/span> <input type='checkbox' checked='checked' class='chkSelectElement' id='select_",customIndicatorLiMiddle="<\/span>  <a href='javascript:void(0)'  class='editLnk'",customIndicatorLiTail=">Edit<\/a><\/li>",agentWidth=0,gbl_array_data={},gbl_high_freequencyenabled,gbl_high_frequency_array_data={},gbl_time_control_Id,gbl_time_target_Id,gbl_array_member_list={},gbl_array_member_selected={},gblselectionChanged={},gbl_array_member_selected_clone={},gbl_array_book_attributes,threshold=3e3,gbl_subnationalHierarchy,gbl_start_var=1,gbl_end_var=threshold,gbl_remove_search=!1,gbl_display_list={},gbl_hierarchy="",startText="",endText="",gbl_start_var_time=1,gbl_end_var_time=threshold,gbl_selected_time_dim_tab,timeDimArray=[],liCounter=0,timePaging=!1,isdownloadlimit=!1,gbl_SubnationalFilter=!1,gbl_SubnationalLevelData=[],gbl_subnationalTotalCount=0;$(document).ready(function(){moveAddMoreLinksToRHS();initMetadataView();initSearch();initJumpToList();initSelectAll();initSelectMembers();setIframeDimension();initCustomPeriodSettings();gbl_HasIndicatorUnit&&initBookAttributes();$(document).resize(function(){$(document).width<1024&&$("body").css({width:"1024px","overflow-x":"auto"})});triggerClickOnEnter();$("#btnMapRegion").off("click");$("#btnMapRegion").on("click",function(){buildSelectFilter("Region")});$("li.addMoreHiddenDiv").off("click");$("li.addMoreHiddenDiv").on("click",function(){CloseOpenedTimeSection()});$("#btnMapIncome").off("click");$("#btnMapIncome").on("click",function(){buildSelectFilter("Income")});$("#selCustomTime_From").off("change");$("#selCustomTime_From").change(function(){if($("#selCustomTime_To").val()<$("#selCustomTime_From").val())return alert("From year must less than or equal to To year"),$("#selCustomTime_From").val($("#selCustomTime_From option:first").val()),!1;var n=$(this).parents(".panel").find(".availableView").attr("data-type");TrackFeature("Variables->"+getPanelHeading(this)+"->Create Time Function->Span->From Time")});$("#selCustomTime_To").off("change");$("#selCustomTime_To").change(function(){if($("#selCustomTime_To").val()<$("#selCustomTime_From").val())return alert("To year must greater than or equal to From year"),$("#selCustomTime_To").val($("#selCustomTime_To option:first").val()),!1;var n=$(this).parents(".panel").find(".availableView").attr("data-type");TrackFeature("Variables->"+getPanelHeading(this)+"->Create Time Function->Span->To Time")});$("body").on("click","#liMetadataDownloadAdvanced",function(){setActiveTab("#lblAllMetadata","#allAvailableMetadata")});$("#upReportDD select").off("change");$("#upReportDD select").change(function(n){n.currentTarget.selectedOptions!=null&&n.currentTarget.selectedOptions.length>0&&TrackFeature("Variables->Load Table data for->"+n.currentTarget.selectedOptions[0].text)});$("span.icon-help").off("click");$("span.icon-help").click(function(n){var t;n.target!=null&&n.target.parentElement!=null&&(t=n.target.parentElement.getAttribute("data-target"));t=="#customIndicatorHelpText"?TrackFeature("Variables->Custom indicator Help Text"):t=="#aggHelpTxt"?TrackFeature("Variables->Aggregation Help Text"):t=="#timeFunctionHelpTxt"?TrackFeature("Variables->Custom time Help Text"):t=="#customGroupHelpText"&&TrackFeature("Variables->Custom Country Help Text")});toggleFilterHierarchy();filterCountryAggregates();$("body").addClass(gbl_common_culture)});$(document).ready(function(){positionElements();$(".collapsedOption").click(function(){$(this).hide();$(this).next().show()});$(".expandedOption h4").click(function(){$(this).parent().hide();$(this).parent().siblings(".collapsedOption").show()});showVariableDropdown();togglFilter();checkSelectedPageLoad();initTreeView();$("#tableView").show();viewToggler();addSelectedClass();hideOnDocClick();showToolTip();$(window).resize(function(){positionElements();$("#zoomView").hasClass("in")&&adjustVariableListWidth()});toggleSelectionView();showAvailableSelectedView();showPlusIconOnExpand();radioBtnTab();viewRecentYears();cloneDivs();showAdditionalOptions();$(".tree").on("click",".toggleList",function(){$(this).toggleClass("open");$(this).parent(".parentNode").siblings(".childNodes").slideToggle()});$(".tree").on("click",".toggleListText",function(){$(this).siblings(".toggleList").toggleClass("open");$(this).parent(".parentNode").siblings(".childNodes").slideToggle()});$(".dxgvTable_GridDefaultTheme tr:first-child").show();$(".rptdbheader").on("click",function(){var n=$("#hdnCubeID").val(),t=gbl_isCubePublic;loadDatabaseDetails(n,t)})})