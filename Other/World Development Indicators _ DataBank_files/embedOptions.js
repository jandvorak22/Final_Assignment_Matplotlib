function chooseEmbedFrameSize(){$(".btnEmbedSize").click(function(){var n=$(this).attr("embed-size"),t,i;n=n.split("X");t=n[0];i=n[1];$("#chartWrapper").attr("width",t);$("#chartWrapper").attr("height",i);$("#inputEmbedWidth").val(t);$("#inputEmbedHeight").val(i);showembedloading();$("#chartWrapper").attr("src","");$("#chartWrapper").attr("src",gbl_embedsource_src);generateCode()});$("#inputEmbedWidth").blur(function(){var n=$(this).val();$("#chartWrapper").attr("width",n);n<=500&&($(".btnEmbedSize").removeClass("active"),$("#embedSmallSize").addClass("active"));n>500&&n<=750&&($(".btnEmbedSize").removeClass("active"),$("#embedMediumSize").addClass("active"));n>750&&($(".btnEmbedSize").removeClass("active"),$("#embedLargeSize").addClass("active"));showembedloading();$("#chartWrapper").attr("src","");$("#chartWrapper").attr("src",gbl_embedsource_src);generateCode();TrackFeature("Embed->Embed Dimensions->Custom Width")});$("#inputEmbedHeight").blur(function(){var t=$(this).val(),n=$("#inputEmbedWidth").val();$("#chartWrapper").attr("height",t-50);n<=500&&($(".btnEmbedSize").removeClass("active"),$("#embedSmallSize").addClass("active"));n>500&&n<=750&&($(".btnEmbedSize").removeClass("active"),$("#embedMediumSize").addClass("active"));n>750&&($(".btnEmbedSize").removeClass("active"),$("#embedLargeSize").addClass("active"));showembedloading();$("#chartWrapper").attr("src","");$("#chartWrapper").attr("src",gbl_embedsource_src);TrackFeature("Embed->Embed Dimensions->Custom Height")})}function showembedloading(){var n=$("#chartWrapper").contents().find("body"),t=parseInt(n.height()/2);n.html($("#report-loading")[0].outerHTML);n.find("#report-loading").css("top",t+"px").css("width","90%").css("text-align","center").css("position","absolute").show();setTimeout(function(){n.find("#report-loading img").attr("src",gbl_basepath+"images/ajax-loader.gif")},200)}function showHideEntities(){$("#chkDimensionDpDwn").on("click",function(){TrackFeature("Embed->Display->Dimension dropdown");$(this).is(":checked")?$("#chartWrapper").contents().find("#REPORT_PREVIEW_divdropdown").show():$("#chartWrapper").contents().find("#REPORT_PREVIEW_divdropdown").hide();generateCode()});$("#chkMetadataDimensionDpDwn").on("click",function(){$(this).is(":checked")?$("#chartWrapper").contents().find(".metadata-tools").show():$("#chartWrapper").contents().find(".metadata-tools").hide();$(this).is(":checked")?$("#chartWrapper").contents().find(".columnContent").css("top","70px"):$("#chartWrapper").contents().find(".columnContent").css("top","40px");generateCode()});$("#chkLinkBar").on("click",function(){TrackFeature("Embed->Display->Toolbar");$(this).is(":checked")?$("#chartWrapper").contents().find("#embedLinks").fadeIn("fast",function(){$(".secondary").removeAttr("disabled");$("#availableThemes").show();$(".secondary").prop("checked",!0);$("#embedLinkList li a").show()}):$("#chartWrapper").contents().find("#embedLinks").fadeOut("fast",function(){$(".secondary").attr("disabled",!0);$("#availableThemes").hide();$(".secondary").prop("checked",!0);$(".tertiary").prop("disabled",!0)});generateCode()});$("#chkShareLink").on("click",function(){TrackFeature("Embed->Display->Share");$(this).is(":checked")?$("#chartWrapper").contents().find("#shareLink").show():$("#chartWrapper").contents().find("#shareLink").hide();generateCode()});$("#chkDownloadLink").on("click",function(){TrackFeature("Embed->Display->Download");$(this).is(":checked")?$("#chartWrapper").contents().find("#downloadLink").show("fast",function(){$(".tertiary").prop("checked",!0);$(".tertiary").prop("disabled",!1);generateCode()}):$("#chartWrapper").contents().find("#downloadLink").hide("fast",function(){$(".tertiary").prop("disabled",!0);generateCode()})});$("#chkPrintLink").on("click",function(){TrackFeature("Embed->Display->Print");$(this).is(":checked")?$("#chartWrapper").contents().find("#printLink").show():$("#chartWrapper").contents().find("#printLink").hide();generateCode()});$("#chkNavigator").on("click",function(){TrackFeature("Embed->Display->Navigator");showembedloading();generateCode();$("#chartWrapper").attr("src","");$("#chartWrapper").attr("src",gbl_embedsource_src)});$("#chkEmbedShowZoombar").on("click",function(){$(this).is(":checked")?($("#chartWrapper").contents().find("#map_zoom_slider").show(),$("#chartWrapper").contents().find("#hdnShowZoombar").val("1")):($("#chartWrapper").contents().find("#map_zoom_slider").hide(),$("#chartWrapper").contents().find("#hdnShowZoombar").val("0"));generateCode()});$("#chkEmbedShowLegend").on("click",function(){$(this).is(":checked")?($("#chartWrapper").contents().find("#legend").show(),$("#chartWrapper").contents().find("#hdnShowLegend").val("1")):($("#chartWrapper").contents().find("#legend").hide(),$("#chartWrapper").contents().find("#hdnShowLegend").val("0"));generateCode()});$("#chkInfoLink").on("click",function(){$(this).is(":checked")?$("#chartWrapper").contents().find("#infoLink").show():$("#chartWrapper").contents().find("#infoLink").hide();generateCode()});$("#chkExcel").on("click",function(){TrackFeature("Embed->Display->Download->Excel");$(this).is(":checked")?$("#chartWrapper").contents().find(".downloadExcel").show():$("#chartWrapper").contents().find(".downloadExcel ").hide();generateCode()});$("#chkCSV").on("click",function(){TrackFeature("Embed->Display->Download->CSV");$(this).is(":checked")?$("#chartWrapper").contents().find(".downloadCSV").show():$("#chartWrapper").contents().find(".downloadCSV").hide();generateCode()});$("#chkTabbedTxt").on("click",function(){TrackFeature("Embed->Display->Download->Tabbed TXT");$(this).is(":checked")?$("#chartWrapper").contents().find(".downloadTAB").show():$("#chartWrapper").contents().find(".downloadTAB").hide();generateCode()});$("#embedSmallSize").off("click");$("#embedSmallSize").on("click",function(){TrackFeature("Embed->Embed Dimensions->Present->Small")});$("#embedMediumSize").off("click");$("#embedMediumSize").on("click",function(){TrackFeature("Embed->Embed Dimensions->Present->Medium")});$("#embedLargeSize").off("click");$("#embedLargeSize").on("click",function(){TrackFeature("Embed->Embed Dimensions->Present->Large")});$("#selDescFontStyle").change(function(){var n=$(this).val();n=="bold"&&$("#chartWrapper").contents().find("#widgetDesc").css({"font-weight":"bold","font-style":"normal"});n=="bold italic"&&$("#chartWrapper").contents().find("#widgetDesc").css({"font-weight":"bold","font-style":"italic"});n=="italic"&&$("#chartWrapper").contents().find("#widgetDesc").css({"font-weight":"normal","font-style":"italic"});n=="normal"&&$("#chartWrapper").contents().find("#widgetDesc").css({"font-style":"normal","font-weight":"normal"});generateCode();TrackFeature("Embed->Title & Description->Show Description->Font style")});$("#radioBtnShowDesc").click(function(){$("#chartWrapper").contents().find("#widgetDesc").show();generateCode()});$("#selDescFont").change(function(){var n=$(this).val();$("#chartWrapper").contents().find("#widgetDesc").css({"font-family":n});generateCode();TrackFeature("Embed->Title & Description->Show Description->Font Type")});$("#selDescFontSize").change(function(){var n=$(this).val();$("#chartWrapper").contents().find("#widgetDesc").css({"font-size":n});generateCode();TrackFeature("Embed->Title & Description->Show Description->Font Size")});$("#selDescAlignment").change(function(){var n=$(this).val();$("#chartWrapper").contents().find("#widgetDesc").css({"text-align":n});generateCode();TrackFeature("Embed->Title & Description->Show Description->Horizondal Alignment")});$("#selTitleFontStyle").change(function(){var n=$(this).val();n=="bold"&&$("#chartWrapper").contents().find("#widgetTitle").css({"font-weight":"bold","font-style":"normal"});n=="bold italic"&&$("#chartWrapper").contents().find("#widgetTitle").css({"font-weight":"bold","font-style":"italic"});n=="italic"&&$("#chartWrapper").contents().find("#widgetTitle").css({"font-weight":"normal","font-style":"italic"});n=="normal"&&$("#chartWrapper").contents().find("#widgetTitle").css({"font-style":"normal","font-weight":"normal"});generateCode();TrackFeature("Embed->Title & Description->Show Title->Font style")});$("#radioBtnShowTitle").click(function(){TrackFeature("Embed->Title & Description->Show Title");$("#chartWrapper").contents().find("#widgetTitle").show();generateCode()});$("#radioBtnHideTitle").click(function(){TrackFeature("Embed->Title & Description->Hide Title");$("#chartWrapper").contents().find("#widgetTitle").hide();generateCode()});$("#radioBtnShowDesc").click(function(){TrackFeature("Embed->Title & Description->Show Description");$("#chartWrapper").contents().find("#widgetDesc").show();generateCode()});$("#radioBtnHideDesc").click(function(){TrackFeature("Embed->Title & Description->Hide Description");$("#chartWrapper").contents().find("#widgetDesc").hide();generateCode()});$("#selTitleFont").change(function(){var n=$(this).val();$("#chartWrapper").contents().find("#widgetTitle").css({"font-family":n});generateCode();TrackFeature("Embed->Title & Description->Show Title->Font Type")});$("#selTitleFontSize").change(function(){var n=$(this).val();$("#chartWrapper").contents().find("#widgetTitle").css({"font-size":n});generateCode();TrackFeature("Embed->Title & Description->Show Title->Font Size")});$("#selTitleAlignment").change(function(){var n=$(this).val();$("#chartWrapper").contents().find("#widgetTitle").css({"text-align":n});generateCode();TrackFeature("Embed->Title & Description->Show Title->Horizontal Alignment")});$("#borderWidth").change(function(){TrackFeature("Embed->Canvas Options->Border Width");$(this).find(":selected").val()!="None"&&($("#chartWrapper").contents().find("#widgetpreview").css("border-width",$(this).find(":selected").val().split("px")[0]+"px"),$("#borderStyle,#canvasBorder").show());generateCode()});$("#borderStyle").change(function(){TrackFeature("Embed->Canvas Options->Border Style");$("#chartWrapper").contents().find("#widgetpreview").css("border-style",$(this).find(":selected").val());generateCode()});$("#txtTitle").keyup(function(){$("#widgetTitle",getFrame().documentElement).html($("#txtTitle").val())});$("#txtDesc").keyup(function(){$("#widgetDesc",getFrame().documentElement).html($("#txtDesc").val())});$("#radioBtnShowTitle, #radioBtnShowDesc").on("click",function(){$("#txtTitle").val()==""&&$("#txtTitle").val($("#widgetTitle",getFrame().documentElement).html());$("#txtDesc").val()==""&&$("#txtDesc").val($("#widgetDesc",getFrame().documentElement).html())});$(".applyChangesEmbed").on("click",function(){var n=$("#hdnReportID").val();if(n==""||parseInt(n)<=0){alert("Please save the report before apply changes.");return}$.ajax({type:"POST",url:gbl_report_methods+"/SaveTitleDescReports",contentType:"application/json; charset=utf-8",data:"{reportid: "+n+', title:"'+$("#txtTitle").val()+'", description:"'+$("#txtDesc").val()+'"}',dataType:"json",success:function(n){n.d!=""&&alert("Failed to save Title and Descrption")},error:function(){$("#report-loading").fadeOut(500);window.location.href="../../ddperror.aspx"}});TrackFeature("Embed->Title & Description->Apply changes")})}function getFrame(){var n=document.getElementById("chartWrapper");return n.contentDocument||n.contentWindow.document}function initAvailableThemeSel(){$(".availableThemeList li").on("click",function(){TrackFeature("Embed->Toolbar Themes");var n=$(this).attr("id");$(".availableThemeList li").removeClass("active");$(this).addClass("active");$("#chartWrapper").contents().find("#embedLinkList li").attr("class","");$("#chartWrapper").contents().find("#embedLinkList li").addClass(n);$("#chartWrapper").contents().find("#infoLinkDesc").attr("class","");$("#chartWrapper").contents().find("#downloadLinkDesc").attr("class","");$("#chartWrapper").contents().find("#shareLinkDesc").attr("class","");$("#chartWrapper").contents().find("#infoLinkDesc").addClass("embedLinkDesc");$("#chartWrapper").contents().find("#downloadLinkDesc").addClass("embedLinkDesc");$("#chartWrapper").contents().find("#shareLinkDesc").addClass("embedLinkDesc");$("#chartWrapper").contents().find("#infoLinkDesc").addClass(n);$("#chartWrapper").contents().find("#downloadLinkDesc").addClass(n);$("#chartWrapper").contents().find("#shareLinkDesc").addClass(n);generateCode()})}function generateEmbedForMap(n,t){gbl_map_zoomdata=n;gbl_map_extentdata=t;generateCode()}function generateCode(){var t,i,nt,r,u,tt,e,it;$(".embed").val("");var o,s,v,y,p,w,b,k,d,rt,ut,ft,f,g,h="",et=$(".availableThemeList li.active").attr("id"),c=$("#canvasBorder")[0].color==null?"rgb(255,255,255)":$("#canvasBorder")[0].color.active.val("rgb"),ot=$("#borderStyle").val(),st=$("#borderWidth").val();o=$("#radioBtnShowTitle").hasClass("active")?"y":"n";s=$("#radioBtnShowDesc").hasClass("active")?"y":"n";v=$("#chkDimensionDpDwn").is(":checked")?"y":"n";md=$("#chkMetadataDimensionDpDwn").is(":checked")?"y":"n";y=$("#chkLinkBar").is(":checked")?"y":"n";p=$("#chkShareLink").is(":checked")?"y":"n";w=$("#chkDownloadLink").is(":checked")?"y":"n";b=$("#chkPrintLink").is(":checked")?"y":"n";g=$("#chkNavigator").is(":checked")?"y":"n";k=$("#chkInfoLink").is(":checked")?"y":"n";d="y";var ht=$("#inputEmbedWidth").val(),ct=$("#inputEmbedHeight").val(),l=$("#selTitleFontColor")[0].color==null?"rgb(255,255,255)":$("#selTitleFontColor")[0].color.active.val("rgb"),a=$("#selDescColor")[0].color==null?"rgb(255,255,255)":$("#selDescColor")[0].color.active.val("rgb"),n="";if($(".downloadopt").each(function(){this.checked&&(n!=""&&(n+=","),n+=this.id.replace("chk",""))}),toSaveOptions="ti="+o+"&ds="+s+"&dd="+v+"&tb="+y+"&sh="+p+"&dw="+w+"&pr="+b+"&inf="+k+"&zm="+d+"&md="+md,$("#chkXAxis").length>0&&(toSaveOptions+="&xlbl="+rt+"&ylbl="+ut+"&legend="+ft),toSaveOptions+="&navigator="+g+"&theme="+et+"&bdrClr=rgb("+c.r+","+c.g+","+c.b+")&bdrStyle="+ot+"&bdrWidth="+st,o=="y"){nt=$("#selTitleFontStyle").val();switch(nt){case"bold":t=!0;i=!1;break;case"bold italic":t=!0;i=!0;break;case"italic":t=!1;i=!0;break;case"normal":t=!1;i=!1}toSaveOptions+="&title="+$("#selTitleFont").val()+";"+$("#selTitleFontSize").val()+";"+t+";"+i+";rgb("+l.r+","+l.g+","+l.b+");"+$("#selTitleAlignment").val()}if(s=="y"){tt=$("#selDescFontStyle").val();switch(tt){case"bold":r=!0;u=!1;break;case"bold italic":r=!0;u=!0;break;case"italic":r=!1;u=!0;break;case"normal":r=!1;u=!1}toSaveOptions+="&desc="+$("#selDescFont").val()+";"+$("#selDescFontSize").val()+";"+r+";"+u+";rgb("+a.r+","+a.g+","+a.b+");"+$("#selDescAlignment").val()}return toSaveOptions+=f!=null&&f!=""&&f=="y"?"&exptypes="+n+"&oms="+f:"&exptypes="+n,$("#hdnReportType").val().toUpperCase()=="MAP"&&(toSaveOptions+="&maplegend="+($("#chkEmbedShowLegend").prop("checked")?"Y":"N"),toSaveOptions+="&zoom="+($("#chkEmbedShowZoombar").prop("checked")?"Y":"N"),gbl_map_zoomdata!=""&&(toSaveOptions+="&zoomlevel="+gbl_map_zoomdata),gbl_map_extentdata!=""&&(toSaveOptions+="&latlon="+gbl_map_extentdata)),h=getEmbedURL(),e=h+(h.indexOf("?")>0?"&":"?")+toSaveOptions,it="<iframe frameBorder='no' src=\""+e+'" width= "'+ht+'"  height="'+ct+'"><\/iframe>',gbl_embedsource_src=e,$("#txtEmbedCode").val(it),e}function getEmbedURL(){var n="";return $("#hdnReportURL").val()!=""&&(n="https://"+gbl_baseurl+"embed/"+$("#hdnReportURL").val()),n}function initializeJPickerEmdebOpt(){$(".colorPickerEmdebOpt").jPicker({window:{expandable:!0},color:{alphaSupport:!0,active:new $.jPicker.Color({ahex:"#444444"})},position:{x:"screenCenter",y:"0px"}},function(n){TrackFeature("Embed->Canvas Options->Color Picker");var t=n.val("all").hex||"transparent",i=$(this).attr("id");switch(i){case"selTitleFontColor":$("#chartWrapper").contents().find("#widgetTitle").css("color","#"+t);generateCode();break;case"selDescColor":$("#chartWrapper").contents().find("#widgetDesc").css("color","#"+t);generateCode();break;case"canvasBorder":$("#chartWrapper").contents().find("#widgetpreview").css("border-color","#"+t);generateCode()}})}function generateEmbedCode(n){n=="share";n=="share"?($("#lnkPermReportLink").html(getEncodedUrl()),$("#lnkPermReportLink").attr("href",getEncodedUrl())):generateCode()}var gbl_embedsource_src=gbl_embedpath,gbl_map_zoomdata,gbl_map_extentdata;$(document).ready(function(){chooseEmbedFrameSize();showHideEntities();initAvailableThemeSel();initializeJPickerEmdebOpt()});gbl_map_zoomdata="";gbl_map_extentdata=""